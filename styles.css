
    :root {
      --bg-dark: #0d0d12;
      --void-core: #7b2cbf;
      --void-mid: #9d4edd;
      --flame-core: #ff6b35;
      --flame-mid: #f7931e;
    }

    html, body {
      height: 100%;
      width: 100%;
      background: #2c2c3a;
      font-family: 'Press Start 2P', cursive;
      overflow: hidden;
      display: flex;
      align-items: center;
      justify-content: center;
      touch-action: manipulation;
    }

    .gameboy-shell {
      background: linear-gradient(145deg, #7b6ba5 0%, #6b5b95 30%, #5a4a84 70%, #4a3a74 100%);
      padding: 1.4rem 1rem 0.5rem 1rem;
      border-radius: 12px 12px 45px 45px;
      box-shadow:
        inset 0 2px 4px rgba(255,255,255,0.3),
        inset 0 -2px 6px rgba(0,0,0,0.3),
        0 12px 50px rgba(0,0,0,0.6),
        0 0 0 3px #3a2a54;
      position: relative;
    }

    /* Shell ridge details */
    .gameboy-shell::before {
      content: '';
      position: absolute;
      top: 8px;
      left: 8px;
      right: 8px;
      height: 4px;
      background: linear-gradient(90deg, transparent 0%, rgba(255,255,255,0.1) 20%, rgba(255,255,255,0.15) 50%, rgba(255,255,255,0.1) 80%, transparent 100%);
      border-radius: 2px;
    }

    /* Power OFF switch - left side of shell */
    .power-off-switch {
      position: absolute;
      left: -18px;
      top: 50%;
      transform: translateY(-50%);
      width: 14px;
      height: 50px;
      background: linear-gradient(90deg, #3a3a4a 0%, #4a4a5a 50%, #3a3a4a 100%);
      border-radius: 4px 0 0 4px;
      cursor: pointer;
      box-shadow:
        inset 1px 0 2px rgba(255,255,255,0.1),
        -2px 0 4px rgba(0,0,0,0.3);
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: flex-start;
      padding-top: 4px;
      z-index: 50;
      transition: background 0.2s;
    }

    .power-off-switch:hover {
      background: linear-gradient(90deg, #4a4a5a 0%, #5a5a6a 50%, #4a4a5a 100%);
    }

    .power-off-switch:active .power-off-slider {
      top: 28px;
    }

    .power-off-slider {
      width: 10px;
      height: 18px;
      background: linear-gradient(180deg, #666 0%, #444 50%, #333 100%);
      border-radius: 2px;
      position: relative;
      top: 4px;
      transition: top 0.15s;
      box-shadow:
        inset 0 1px 0 rgba(255,255,255,0.3),
        0 2px 3px rgba(0,0,0,0.4);
    }

    .power-off-label {
      font-size: 5px;
      color: rgba(255,255,255,0.4);
      margin-top: auto;
      margin-bottom: 4px;
      letter-spacing: 0.5px;
    }

    /* Screen blackout when powering off */
    .viewport.powering-off {
      animation: screenOff 0.8s ease-out forwards;
    }

    @keyframes screenOff {
      0% { filter: brightness(1); }
      20% { filter: brightness(1.5) contrast(1.2); }
      40% { filter: brightness(0.8); }
      100% {
        filter: brightness(0);
        background: #000;
      }
    }

    /* Mode switch - top of shell */
    .mode-switch-container {
      position: absolute;
      top: -12px;
      left: 15px;
      display: flex;
      align-items: center;
      gap: 6px;
      z-index: 100;
    }

    .mode-label {
      font-size: 6px;
      color: rgba(255,255,255,0.5);
      letter-spacing: 0.5px;
    }

    .mode-label.active {
      color: rgba(255,255,255,0.9);
    }

    .power-switch {
      width: 36px;
      height: 16px;
      background: linear-gradient(180deg, #2a2a3a 0%, #1a1a2a 50%, #0a0a1a 100%);
      border-radius: 3px;
      cursor: pointer;
      box-shadow:
        inset 0 2px 4px rgba(0,0,0,0.8),
        0 1px 0 rgba(255,255,255,0.1);
      position: relative;
    }

    .power-switch::before {
      content: '';
      position: absolute;
      top: 2px;
      left: 2px;
      width: 14px;
      height: 12px;
      background: linear-gradient(180deg, #707080 0%, #505060 50%, #404050 100%);
      border-radius: 2px;
      transition: left 0.15s ease-out;
      box-shadow:
        inset 0 1px 1px rgba(255,255,255,0.4),
        0 1px 2px rgba(0,0,0,0.5);
    }

    .power-switch.on::before {
      left: 20px;
    }

    .gameboy-shell.dmg-mode .mode-label.left { color: rgba(80,80,72,0.9); }
    .gameboy-shell.dmg-mode .mode-label.right { color: rgba(80,80,72,0.5); }
    .gameboy-shell:not(.dmg-mode) .mode-label.left { color: rgba(255,255,255,0.5); }
    .gameboy-shell:not(.dmg-mode) .mode-label.right { color: rgba(255,255,255,0.9); }

    .gameboy-shell.dmg-mode .power-switch {
      background: linear-gradient(180deg, #606058 0%, #505048 50%, #404038 100%);
      box-shadow: inset 0 2px 4px rgba(0,0,0,0.5), 0 1px 0 rgba(255,255,255,0.2);
    }

    .gameboy-shell.dmg-mode .power-switch::before {
      background: linear-gradient(180deg, #a0a098 0%, #888880 50%, #707068 100%);
    }

    .gameboy-shell.dmg-mode .mode-switch-container .mode-label {
      color: rgba(80,80,72,0.6);
    }

    .gameboy-header {
      position: relative;
      display: flex;
      align-items: center;
      justify-content: center;
      margin-bottom: 0.3rem;
      padding-top: 0.2rem;
    }

    .gameboy-label {
      font-size: 8px;
      color: rgba(255,255,255,0.8);
      white-space: nowrap;
      text-shadow: 0 1px 2px rgba(0,0,0,0.3);
    }

    .gameboy-label span {
      background: linear-gradient(90deg, #ff6b6b, #ffd93d, #6bcb77, #4d96ff, #9d65c9);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }

    /* DMG Mode - Classic grey Game Boy (colors only, no layout changes) */
    .gameboy-shell.dmg-mode {
      background: linear-gradient(180deg, #d4d4c8 0%, #c8c8bc 15%, #bcbcb0 50%, #b0b0a4 85%, #a0a094 100%);
      box-shadow:
        inset 0 2px 4px rgba(255,255,255,0.6),
        inset -2px 0 3px rgba(0,0,0,0.1),
        inset 2px 0 3px rgba(0,0,0,0.1),
        inset 0 -3px 6px rgba(0,0,0,0.15),
        0 12px 50px rgba(0,0,0,0.5),
        0 0 0 3px #909088;
    }

    /* DMG vertical lines/ridges overlay */
    .gameboy-shell.dmg-mode::before {
      top: 8px;
      left: 6px;
      right: auto;
      width: 6px;
      height: calc(100% - 50px);
      background: repeating-linear-gradient(180deg,
        #b8b8ac 0px, #b8b8ac 3px,
        #a8a89c 3px, #a8a89c 6px);
    }

    .gameboy-shell.dmg-mode .power-switch {
      background: linear-gradient(180deg, #808078 0%, #707068 50%, #606058 100%);
      border-radius: 3px 3px 1px 1px;
    }

    .gameboy-shell.dmg-mode .power-switch::before {
      background: linear-gradient(180deg, #a0a098 0%, #909088 100%);
    }

    .gameboy-shell.dmg-mode .power-switch.on::before {
      background: linear-gradient(180deg, #c84040 0%, #a83030 100%);
    }

    .gameboy-shell.dmg-mode .gameboy-label {
      color: #505048;
      font-size: 9px;
      letter-spacing: 2px;
      text-shadow: 0 1px 1px rgba(255,255,255,0.6);
    }

    .gameboy-shell.dmg-mode .gameboy-label span {
      background: none;
      -webkit-text-fill-color: #404038;
      color: #404038;
    }

    .gameboy-shell.dmg-mode .viewport {
      filter: sepia(100%) hue-rotate(50deg) saturate(60%) brightness(90%) contrast(110%);
      background: linear-gradient(180deg, #8bac0f 0%, #9bbc0f 30%, #306230 60%, #0f380f 100%);
    }

    .gameboy-shell.dmg-mode .screen-bezel {
      background: linear-gradient(180deg, #505048 0%, #606058 100%);
      box-shadow: inset 0 4px 12px rgba(0,0,0,0.7);
    }

    .gameboy-shell.dmg-mode .screen-bezel::before {
      content: 'DOT MATRIX WITH STEREO SOUND';
      position: absolute;
      top: 6px;
      left: 50%;
      transform: translateX(-50%);
      font-size: 4px;
      color: #808078;
      letter-spacing: 1px;
      white-space: nowrap;
      font-weight: normal;
      z-index: 5;
    }

    .gameboy-shell.dmg-mode .power-led {
      background: #cc3030;
      box-shadow: 0 0 8px #ff4040;
      width: 6px;
      height: 6px;
    }

    /* Battery label for DMG */
    .battery-label {
      display: none;
    }

    .gameboy-shell.dmg-mode .battery-label {
      display: block;
      position: absolute;
      top: 6px;
      left: 88px;
      font-size: 4px;
      color: #707068;
      letter-spacing: 0.5px;
    }

    /* Nintendo GAME BOY brand below screen for DMG */
    .dmg-brand {
      display: none;
    }

    .gameboy-shell.dmg-mode .dmg-brand {
      display: block;
      position: absolute;
      left: 50%;
      transform: translateX(-50%);
      margin-top: 8px;
      text-align: center;
    }

    .gameboy-shell.dmg-mode .dmg-brand .nintendo-text {
      font-size: 6px;
      color: #2a2a28;
      letter-spacing: 3px;
      margin-bottom: 2px;
    }

    .gameboy-shell.dmg-mode .dmg-brand .gameboy-text {
      font-size: 11px;
      color: #1a1a18;
      letter-spacing: 1px;
      font-weight: bold;
    }

    .gameboy-shell.dmg-mode .dmg-brand .tm-text {
      font-size: 5px;
      vertical-align: super;
      color: #3a3a38;
    }

    /* Hide GBC header label in DMG mode (keep space) */
    .gameboy-shell.dmg-mode .gameboy-header {
      opacity: 0;
      pointer-events: none;
    }

    .screen-bezel {
      background: #1a1a24;
      padding: 0.5rem;
      border-radius: 8px;
      box-shadow: inset 0 4px 12px rgba(0,0,0,0.8);
      position: relative;
    }

    .viewport {
      width: min(88vw, 88vh, 500px);
      height: min(88vw, 88vh, 500px);
      background: linear-gradient(180deg, #88c8e8 0%, #78b8d8 30%, #98d868 60%, #78b858 100%);
      border-radius: 3px;
      position: relative;
      overflow: hidden;
      image-rendering: pixelated;
    }

    .viewport.shake {
      animation: screenShake 0.3s ease-out;
    }

    @keyframes screenShake {
      0%, 100% { transform: translateX(0); }
      20% { transform: translateX(-5px); }
      40% { transform: translateX(5px); }
      60% { transform: translateX(-3px); }
      80% { transform: translateX(3px); }
    }

    /* Mode switch shader transition - DMG to Color (warm colorization) */
    .viewport.mode-transition-color {
      animation: colorWarm 0.6s ease-out;
    }

    @keyframes colorWarm {
      0% {
        filter: brightness(1) saturate(0) sepia(0.3);
      }
      30% {
        filter: brightness(1.05) saturate(0.4) sepia(0.2);
      }
      60% {
        filter: brightness(1.02) saturate(0.8) sepia(0.05);
      }
      100% {
        filter: brightness(1) saturate(1) sepia(0);
      }
    }

    /* Warm glow overlay during colorization */
    .viewport.mode-transition-color::after {
      content: '';
      position: absolute;
      inset: 0;
      background: radial-gradient(ellipse at center, rgba(255,248,220,0.25) 0%, rgba(255,220,180,0.1) 50%, transparent 80%);
      mix-blend-mode: overlay;
      animation: warmGlow 0.6s ease-out;
      pointer-events: none;
      z-index: 100;
    }

    @keyframes warmGlow {
      0% { opacity: 0; }
      40% { opacity: 1; }
      100% { opacity: 0; }
    }

    /* Color drain shader - Game Boy LCD style */
    .viewport.mode-transition-drain {
      animation: lcdDrain 0.35s ease-in forwards;
    }

    @keyframes lcdDrain {
      0% {
        filter: brightness(1) saturate(1) contrast(1);
        clip-path: inset(0 0 0 0);
      }
      40% {
        filter: brightness(0.7) saturate(0.3) contrast(1.3);
        clip-path: inset(0 0 0 0);
      }
      70% {
        filter: brightness(0.4) saturate(0) contrast(1.5);
        clip-path: inset(20% 0 20% 0);
      }
      100% {
        filter: brightness(0.2) saturate(0) contrast(2);
        clip-path: inset(45% 0 45% 0);
      }
    }

    /* LCD pixel ghost overlay */
    .viewport.mode-transition-drain::after {
      content: '';
      position: absolute;
      inset: 0;
      background: linear-gradient(
        180deg,
        rgba(0,50,0,0) 0%,
        rgba(0,50,0,0.3) 50%,
        rgba(0,50,0,0) 100%
      );
      animation: lcdGhost 0.35s ease-in;
      pointer-events: none;
      z-index: 100;
    }

    @keyframes lcdGhost {
      0% { opacity: 0; transform: scaleY(1); }
      50% { opacity: 1; transform: scaleY(1); }
      100% { opacity: 0; transform: scaleY(0.1); }
    }

    /* Critical hit shader */
    .viewport.crit-flash {
      animation: critShader 0.25s ease-out;
    }

    @keyframes critShader {
      0% {
        filter: invert(0) brightness(1) contrast(1);
        transform: scale(1);
      }
      20% {
        filter: invert(1) brightness(1.5) contrast(1.5);
        transform: scale(1.04);
      }
      40% {
        filter: invert(0) brightness(2) contrast(1.2) saturate(2);
        transform: scale(0.98);
      }
      60% {
        filter: invert(0.3) brightness(1.3) contrast(1.3);
        transform: scale(1.02);
      }
      100% {
        filter: invert(0) brightness(1) contrast(1) saturate(1);
        transform: scale(1);
      }
    }

    /* Crit slash overlay */
    .viewport.crit-flash::after {
      content: '';
      position: absolute;
      inset: 0;
      background: linear-gradient(
        135deg,
        transparent 40%,
        rgba(255,255,255,0.9) 48%,
        rgba(255,255,0,0.8) 50%,
        rgba(255,255,255,0.9) 52%,
        transparent 60%
      );
      animation: critSlash 0.25s ease-out;
      pointer-events: none;
      z-index: 100;
    }

    @keyframes critSlash {
      0% { opacity: 0; transform: translateX(-100%) rotate(0deg); }
      30% { opacity: 1; }
      100% { opacity: 0; transform: translateX(100%) rotate(0deg); }
    }

    /* Scanlines */
    .viewport::before {
      content: '';
      position: absolute;
      inset: 0;
      background: repeating-linear-gradient(0deg, transparent, transparent 2px, rgba(0,0,0,0.03) 2px, rgba(0,0,0,0.03) 4px);
      pointer-events: none;
      z-index: 50;
    }

    /* Pokemon-style HP boxes - FireRed layout */
    .stat-box {
      position: absolute;
      background: linear-gradient(180deg, #f8f0d8 0%, #e8e0c8 100%);
      border: 3px solid #484038;
      padding: 6px 10px;
      min-width: 44%;
      z-index: 20;
    }

    .stat-box.enemy {
      top: 2%;
      left: 2%;
      border-radius: 0 0 10px 0;
    }

    .stat-box.player {
      bottom: 34%;
      right: 2%;
      border-radius: 10px 0 0 0;
    }

    .stat-row {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 6px;
    }

    .stat-name {
      font-size: 14px;
      color: #303030;
      letter-spacing: -0.5px;
    }

    .stat-level {
      font-size: 12px;
      color: #303030;
    }

    .stat-level::before {
      content: 'Lv';
      font-size: 10px;
      margin-right: 2px;
    }

    .hp-row {
      display: flex;
      align-items: center;
      gap: 6px;
    }

    .hp-label {
      font-size: 10px;
      color: #f8a800;
      font-weight: bold;
    }

    .hp-bar-bg {
      flex: 1;
      height: 12px;
      background: #484038;
      border-radius: 6px;
      padding: 2px;
    }

    .hp-bar-inner {
      height: 100%;
      background: linear-gradient(180deg, #58f858 0%, #20b820 100%);
      border-radius: 4px;
      transition: width 0.3s;
    }

    .hp-bar-inner.medium {
      background: linear-gradient(180deg, #f8d830 0%, #c8a820 100%);
    }

    .hp-bar-inner.low {
      background: linear-gradient(180deg, #f85858 0%, #c82020 100%);
    }

    .hp-numbers {
      text-align: right;
      font-size: 11px;
      color: #303030;
      margin-top: 4px;
    }

    /* Battle arena */
    .battle-arena {
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 32%;
    }

    /* Ground platforms - Pokemon FireRed style */
    .platform-enemy {
      position: absolute;
      top: 32%;
      right: 8%;
      width: 35%;
      height: 12px;
      background: linear-gradient(180deg, #90b058 0%, #78a048 100%);
      border-radius: 50%;
      box-shadow: 0 4px 0 #608030;
    }

    .platform-player {
      position: absolute;
      bottom: 2%;
      left: 3%;
      width: 45%;
      height: 16px;
      background: linear-gradient(180deg, #90b058 0%, #78a048 100%);
      border-radius: 50%;
      box-shadow: 0 6px 0 #608030;
    }

    /* Pixel art creatures - FireRed positions */
    .creature {
      position: absolute;
      image-rendering: pixelated;
      z-index: 10;
    }

    .creature-enemy {
      top: 8%;
      right: 18%;
      transform: scaleX(-1);
    }

    .creature-player {
      bottom: 38%;
      left: 15%;
    }

    .pixel-sprite {
      width: 1px;
      height: 1px;
      transform-origin: center;
    }

    /* SWEETBUN - Starting form! Cute round bun */
    .sweetbun-sprite {
      transform: scale(5);
    }

    .sweetbun-sprite .pixel-sprite {
      box-shadow:
        /* SWEETBUN - Cute round glazed bun, upper-left light */
        /* Palette: Shadow #b87333 (copper) → Mid #e8a862 (honey) → Highlight #fff5e6 (cream) */

        /* Round bun body */
        7px 6px 0 #fff5e6, 8px 6px 0 #ffe8cc, 9px 6px 0 #f5d4a8,
        6px 7px 0 #fff5e6, 7px 7px 0 #ffe8cc, 8px 7px 0 #f5d4a8, 9px 7px 0 #e8a862, 10px 7px 0 #d4944a,
        5px 8px 0 #fff5e6, 6px 8px 0 #ffe8cc, 7px 8px 0 #f5d4a8, 8px 8px 0 #e8a862, 9px 8px 0 #d4944a, 10px 8px 0 #c07830, 11px 8px 0 #b87333,
        5px 9px 0 #ffe8cc, 6px 9px 0 #f5d4a8, 7px 9px 0 #e8a862, 8px 9px 0 #d4944a, 9px 9px 0 #c07830, 10px 9px 0 #b87333, 11px 9px 0 #a05a20,
        5px 10px 0 #f5d4a8, 6px 10px 0 #e8a862, 7px 10px 0 #d4944a, 8px 10px 0 #c07830, 9px 10px 0 #b87333, 10px 10px 0 #a05a20, 11px 10px 0 #8b4513,
        6px 11px 0 #d4944a, 7px 11px 0 #c07830, 8px 11px 0 #b87333, 9px 11px 0 #a05a20, 10px 11px 0 #8b4513,
        7px 12px 0 #a05a20, 8px 12px 0 #8b4513, 9px 12px 0 #704010,

        /* Sugar glaze drizzle on top */
        6px 6px 0 #ffffff, 8px 5px 0 #ffffff, 10px 6px 0 #fffaf0,
        7px 7px 0 #fffaf0, 9px 6px 0 #ffffff,

        /* Cute eyes with sparkle */
        6px 8px 0 #1a1a24, 7px 8px 0 #ffffff,
        9px 8px 0 #1a1a24, 10px 8px 0 #ffffff,

        /* Rosy cheeks */
        5px 9px 0 #ffb0a0, 11px 9px 0 #e09080,

        /* Happy little smile */
        7px 10px 0 #8b4513, 8px 10px 0 #704010, 9px 10px 0 #8b4513,

        /* Tiny feet */
        6px 13px 0 #8b4513, 7px 13px 0 #a05a20, 9px 13px 0 #704010, 10px 13px 0 #5c3010;
    }

    /* BAGUETTE - Evolved form with flames! */
    .flame-sprite {
      transform: scale(5);
    }

    .flame-sprite .pixel-sprite {
      box-shadow:
        /* BAGUETTE - Evolved form, upper-left light */
        /* Palette: Shadow #8B5A2B (sienna) → Mid #D4A574 (tan) → Highlight #FFF4D6 (cream) */

        /* Flame crown - light from upper-left */
        7px 3px 0 #fffbe8, 8px 2px 0 #fffbe8,
        6px 4px 0 #ffe066, 7px 4px 0 #fffbe8, 8px 3px 0 #fffbe8, 9px 4px 0 #ffc233,
        5px 5px 0 #ff9500, 6px 5px 0 #ffcc00, 7px 5px 0 #ffe066, 8px 4px 0 #ffe066, 9px 5px 0 #ffc233, 10px 5px 0 #ff7700,
        5px 6px 0 #cc4400, 6px 6px 0 #ff6600, 7px 6px 0 #ff9500, 8px 5px 0 #ffcc00, 9px 6px 0 #ff6600, 10px 6px 0 #cc4400,
        6px 7px 0 #991100, 7px 7px 0 #cc4400, 8px 6px 0 #ff6600, 9px 7px 0 #991100,

        /* Baguette body - upper-left highlight, bottom-right shadow */
        6px 8px 0 #fff4d6, 7px 8px 0 #ffe8b8, 8px 8px 0 #e8c097, 9px 8px 0 #d4a574, 10px 8px 0 #c99a65,
        5px 9px 0 #fff4d6, 6px 9px 0 #ffe8b8, 7px 9px 0 #e8c097, 8px 9px 0 #d4a574, 9px 9px 0 #c99a65, 10px 9px 0 #b8894f, 11px 9px 0 #a67c3d,
        5px 10px 0 #ffe8b8, 6px 10px 0 #e8c097, 7px 10px 0 #d4a574, 8px 10px 0 #c99a65, 9px 10px 0 #b8894f, 10px 10px 0 #a67c3d, 11px 10px 0 #8b5a2b,
        5px 11px 0 #e8c097, 6px 11px 0 #d4a574, 7px 11px 0 #c99a65, 8px 11px 0 #b8894f, 9px 11px 0 #a67c3d, 10px 11px 0 #8b5a2b, 11px 11px 0 #704214,
        6px 12px 0 #c99a65, 7px 12px 0 #b8894f, 8px 12px 0 #a67c3d, 9px 12px 0 #8b5a2b, 10px 12px 0 #704214,
        7px 13px 0 #8b5a2b, 8px 13px 0 #704214, 9px 13px 0 #5c3317,

        /* Eyes - clear focal point with catchlight */
        6px 9px 0 #1a1a24, 7px 9px 0 #ffffff, 9px 9px 0 #1a1a24, 10px 9px 0 #ffffff,
        6px 10px 0 #1a1a24, 9px 10px 0 #1a1a24,

        /* Blush - warm on lit side, cooler on shadow */
        5px 10px 0 #ffb8a8, 11px 10px 0 #e89888,

        /* Feet - grounded */
        6px 14px 0 #704214, 7px 14px 0 #8b5a2b, 9px 14px 0 #5c3317, 10px 14px 0 #4a2c0a;
    }

    /* MEGA BAGUETTE - Final form! Bigger, more flames */
    .mega-flame-sprite {
      transform: scale(6);
    }

    .mega-flame-sprite .pixel-sprite {
      box-shadow:
        /* MEGA BAGUETTE - Evolved form with massive flame crown */

        /* Intense flame crown - towering inferno */
        8px 0px 0 #ffffff, 9px 0px 0 #fffbe8,
        7px 1px 0 #fffbe8, 8px 1px 0 #ffffff, 9px 1px 0 #fffbe8, 10px 1px 0 #ffe066,
        6px 2px 0 #ffe066, 7px 2px 0 #fffbe8, 8px 2px 0 #ffffff, 9px 2px 0 #fffbe8, 10px 2px 0 #ffe066, 11px 2px 0 #ffc233,
        5px 3px 0 #ffc233, 6px 3px 0 #ffe066, 7px 3px 0 #fffbe8, 8px 3px 0 #fffbe8, 9px 3px 0 #ffe066, 10px 3px 0 #ffc233, 11px 3px 0 #ff9500, 12px 3px 0 #ff7700,
        4px 4px 0 #ff9500, 5px 4px 0 #ffcc00, 6px 4px 0 #ffe066, 7px 4px 0 #fffbe8, 8px 4px 0 #ffe066, 9px 4px 0 #ffcc00, 10px 4px 0 #ff9500, 11px 4px 0 #ff6600, 12px 4px 0 #cc4400,
        4px 5px 0 #ff7700, 5px 5px 0 #ff9500, 6px 5px 0 #ffcc00, 7px 5px 0 #ffe066, 8px 5px 0 #ffcc00, 9px 5px 0 #ff9500, 10px 5px 0 #ff6600, 11px 5px 0 #cc4400, 12px 5px 0 #991100,
        5px 6px 0 #cc4400, 6px 6px 0 #ff6600, 7px 6px 0 #ff9500, 8px 6px 0 #ff9500, 9px 6px 0 #ff6600, 10px 6px 0 #cc4400, 11px 6px 0 #991100,
        6px 7px 0 #991100, 7px 7px 0 #cc4400, 8px 7px 0 #ff6600, 9px 7px 0 #cc4400, 10px 7px 0 #991100,

        /* Side flame wings */
        3px 4px 0 #fffbe8, 2px 5px 0 #ffe066, 3px 5px 0 #ffcc00, 3px 6px 0 #ff9500, 2px 6px 0 #ff6600, 2px 7px 0 #cc4400,
        14px 4px 0 #ffe066, 14px 5px 0 #ffc233, 13px 5px 0 #ff9500, 14px 6px 0 #ff6600, 13px 6px 0 #cc4400, 13px 7px 0 #991100,

        /* Larger baguette body */
        5px 8px 0 #fff4d6, 6px 8px 0 #fff4d6, 7px 8px 0 #ffe8b8, 8px 8px 0 #e8c097, 9px 8px 0 #d4a574, 10px 8px 0 #c99a65, 11px 8px 0 #b8894f,
        4px 9px 0 #fff4d6, 5px 9px 0 #ffe8b8, 6px 9px 0 #ffe8b8, 7px 9px 0 #e8c097, 8px 9px 0 #d4a574, 9px 9px 0 #c99a65, 10px 9px 0 #b8894f, 11px 9px 0 #a67c3d, 12px 9px 0 #8b5a2b,
        4px 10px 0 #ffe8b8, 5px 10px 0 #e8c097, 6px 10px 0 #e8c097, 7px 10px 0 #d4a574, 8px 10px 0 #c99a65, 9px 10px 0 #b8894f, 10px 10px 0 #a67c3d, 11px 10px 0 #8b5a2b, 12px 10px 0 #704214,
        4px 11px 0 #e8c097, 5px 11px 0 #d4a574, 6px 11px 0 #d4a574, 7px 11px 0 #c99a65, 8px 11px 0 #b8894f, 9px 11px 0 #a67c3d, 10px 11px 0 #8b5a2b, 11px 11px 0 #704214, 12px 11px 0 #5c3317,
        5px 12px 0 #c99a65, 6px 12px 0 #c99a65, 7px 12px 0 #b8894f, 8px 12px 0 #a67c3d, 9px 12px 0 #8b5a2b, 10px 12px 0 #704214, 11px 12px 0 #5c3317,
        6px 13px 0 #a67c3d, 7px 13px 0 #8b5a2b, 8px 13px 0 #704214, 9px 13px 0 #5c3317, 10px 13px 0 #4a2c0a,

        /* Determined eyes with fire reflection */
        5px 9px 0 #1a1a24, 6px 9px 0 #ff6600, 6px 10px 0 #1a1a24,
        10px 9px 0 #1a1a24, 11px 9px 0 #ff6600, 10px 10px 0 #1a1a24,

        /* Battle-ready blush */
        4px 10px 0 #ff8866, 12px 10px 0 #cc6644,

        /* Sturdy feet */
        5px 14px 0 #5c3317, 6px 14px 0 #704214, 7px 14px 0 #8b5a2b, 9px 14px 0 #5c3317, 10px 14px 0 #4a2c0a, 11px 14px 0 #3a1c00;
    }

    /* Evolution animations - dramatic Pokemon style */
    @keyframes evolve-pulse {
      0%, 100% { transform: scale(1); filter: brightness(1); }
      50% { transform: scale(1.15); filter: brightness(1.5); }
    }

    @keyframes evolve-glow {
      0% { filter: brightness(1) drop-shadow(0 0 0 #fff); }
      20% { filter: brightness(2) drop-shadow(0 0 30px #fff); }
      40% { filter: brightness(4) drop-shadow(0 0 60px #ffe066); }
      60% { filter: brightness(6) drop-shadow(0 0 80px #fff); }
      80% { filter: brightness(3) drop-shadow(0 0 40px #ff9500); }
      100% { filter: brightness(1.2) drop-shadow(0 0 10px #ff6600); }
    }

    @keyframes evolve-silhouette {
      0%, 100% { filter: brightness(1); }
      30%, 70% { filter: brightness(0) drop-shadow(0 0 50px #fff); }
    }

    @keyframes evolve-shake {
      0%, 100% { transform: translateX(0); }
      10%, 30%, 50%, 70%, 90% { transform: translateX(-3px); }
      20%, 40%, 60%, 80% { transform: translateX(3px); }
    }

    .evolving {
      animation: evolve-pulse 0.4s ease-in-out infinite, evolve-shake 0.5s ease-in-out infinite;
    }

    .evolving-flash {
      animation: evolve-glow 2.5s ease-in-out forwards, evolve-silhouette 2.5s ease-in-out forwards;
    }

    /* Pokemon-style evolution - in place with particles */
    @keyframes evo-flash {
      0%, 100% { filter: brightness(1); }
      25%, 75% { filter: brightness(0) drop-shadow(0 0 20px #fff); }
      50% { filter: brightness(3) drop-shadow(0 0 40px #fff); }
    }

    .evo-flashing {
      animation: evo-flash 0.6s ease-in-out infinite;
    }

    /* Hide UI during evolution */
    .viewport.evolution-mode .stat-box,
    .viewport.evolution-mode .battle-panel,
    .viewport.evolution-mode .fight-panel,
    .viewport.evolution-mode .items-panel {
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.5s ease-out;
    }

    /* Status effect indicators */
    .status-icon {
      display: inline-block;
      font-size: 8px;
      padding: 2px 4px;
      border-radius: 3px;
      margin-left: 6px;
      animation: status-pulse 1s ease-in-out infinite;
    }

    .status-icon.burn {
      background: linear-gradient(180deg, #ff6830 0%, #c83820 100%);
      color: #fff;
      box-shadow: 0 0 6px #ff4020;
    }

    .status-icon.poison {
      background: linear-gradient(180deg, #a040c0 0%, #702890 100%);
      color: #fff;
      box-shadow: 0 0 6px #a040c0;
    }

    @keyframes status-pulse {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.6; }
    }

    /* Burn visual effect on creature */
    .creature.burning {
      animation: burn-flicker 0.3s ease-in-out infinite;
    }

    @keyframes burn-flicker {
      0%, 100% { filter: brightness(1); }
      50% { filter: brightness(1.3) sepia(0.3) saturate(1.5); }
    }

    /* Poison visual effect on creature */
    .creature.poisoned {
      animation: poison-pulse 0.8s ease-in-out infinite;
    }

    @keyframes poison-pulse {
      0%, 100% { filter: brightness(1) hue-rotate(0deg); }
      50% { filter: brightness(0.9) hue-rotate(60deg) saturate(1.3); }
    }

    /* Tornado particle around player sprite */
    .evo-particle {
      position: absolute;
      width: 10px;
      height: 10px;
      background: radial-gradient(circle, #fff 0%, #aaf 100%);
      border-radius: 50%;
      pointer-events: none;
      z-index: 30;
      box-shadow: 0 0 8px #fff;
    }

    @keyframes tornado-spin {
      0% { transform: rotate(0deg) translateX(60px) scale(1.2); opacity: 0; }
      20% { opacity: 1; }
      80% { opacity: 1; }
      100% { transform: rotate(540deg) translateX(5px) scale(0.3); opacity: 0; }
    }

    /* VOID SPECTER - Enemy sprite */
    .void-sprite {
      transform: scale(5);
    }

    .void-sprite .pixel-sprite {
      box-shadow:
        /* VOID SPECTER - Upper-left light, hue-shifted palette */
        /* Palette: Shadow #1a0533 (blue-violet) → Mid #7b2cbf (purple) → Highlight #e8c8ff (pink-lavender) */

        /* Hood peak - lit from upper-left */
        7px 3px 0 #e8c8ff, 8px 3px 0 #c77dff, 9px 3px 0 #9d4edd,
        6px 4px 0 #e8c8ff, 7px 4px 0 #c77dff, 8px 4px 0 #9d4edd, 9px 4px 0 #7b2cbf, 10px 4px 0 #5a189a,

        /* Cloak body - dramatic light falloff */
        5px 5px 0 #c77dff, 6px 5px 0 #9d4edd, 7px 5px 0 #7b2cbf, 8px 5px 0 #5a189a, 9px 5px 0 #3c096c, 10px 5px 0 #240046, 11px 5px 0 #1a0533,
        4px 6px 0 #e8c8ff, 5px 6px 0 #9d4edd, 6px 6px 0 #7b2cbf, 7px 6px 0 #5a189a, 8px 6px 0 #3c096c, 9px 6px 0 #240046, 10px 6px 0 #1a0533, 11px 6px 0 #0d0018, 12px 6px 0 #0d0018,
        4px 7px 0 #c77dff, 5px 7px 0 #9d4edd, 6px 7px 0 #7b2cbf, 7px 7px 0 #5a189a, 8px 7px 0 #3c096c, 9px 7px 0 #240046, 10px 7px 0 #1a0533, 11px 7px 0 #0d0018, 12px 7px 0 #0d0018,
        4px 8px 0 #9d4edd, 5px 8px 0 #7b2cbf, 6px 8px 0 #5a189a, 7px 8px 0 #3c096c, 8px 8px 0 #240046, 9px 8px 0 #1a0533, 10px 8px 0 #0d0018, 11px 8px 0 #0d0018, 12px 8px 0 #0d0018,
        5px 9px 0 #7b2cbf, 6px 9px 0 #5a189a, 7px 9px 0 #3c096c, 8px 9px 0 #240046, 9px 9px 0 #1a0533, 10px 9px 0 #0d0018, 11px 9px 0 #0d0018,
        5px 10px 0 #5a189a, 6px 10px 0 #3c096c, 7px 10px 0 #240046, 8px 10px 0 #1a0533, 9px 10px 0 #0d0018, 10px 10px 0 #0d0018,

        /* Wispy tail - fading into void */
        5px 11px 0 #3c096c, 6px 11px 0 #240046, 8px 11px 0 #1a0533, 10px 11px 0 #0d0018,
        4px 12px 0 #3c096c, 7px 12px 0 #1a0533, 9px 12px 0 #0d0018,
        5px 13px 0 #240046, 8px 13px 0 #0d0018,
        6px 14px 0 #1a0533,

        /* Glowing eyes - focal point with glow effect */
        5px 6px 0 #ffcccc, 6px 6px 0 #ff4444, 7px 6px 0 #ff0000, 8px 7px 0 #cc0000,
        5px 7px 0 #ffffff, 6px 7px 0 #ff6666,
        9px 6px 0 #ff4444, 10px 6px 0 #ff8888,
        9px 7px 0 #ff0000, 10px 7px 0 #ffffff;
    }

    /* SLIME - Second enemy sprite (green slime) */
    .slime-sprite {
      transform: scale(5);
    }

    .slime-sprite .pixel-sprite {
      box-shadow:
        /* SLIME - Upper-left light, hue-shifted palette */
        /* Palette: Shadow #1a6060 (teal) → Mid #4a9f4a (green) → Highlight #d4ff98 (yellow-green) */

        /* Top dome - brightest on upper-left */
        6px 5px 0 #e8ffb8, 7px 5px 0 #d4ff98, 8px 5px 0 #b8f878, 9px 5px 0 #8bd858,
        5px 6px 0 #e8ffb8, 6px 6px 0 #d4ff98, 7px 6px 0 #b8f878, 8px 6px 0 #8bd858, 9px 6px 0 #6bcf6b, 10px 6px 0 #4a9f4a, 11px 6px 0 #2a7f5a,

        /* Main body - gradient flows to bottom-right shadow */
        4px 7px 0 #d4ff98, 5px 7px 0 #b8f878, 6px 7px 0 #8bd858, 7px 7px 0 #6bcf6b, 8px 7px 0 #4a9f4a, 9px 7px 0 #3a8f5a, 10px 7px 0 #2a7f5a, 11px 7px 0 #1a6060, 12px 7px 0 #1a6060,
        4px 8px 0 #b8f878, 5px 8px 0 #8bd858, 6px 8px 0 #6bcf6b, 7px 8px 0 #4a9f4a, 8px 8px 0 #3a8f5a, 9px 8px 0 #2a7f5a, 10px 8px 0 #1a6060, 11px 8px 0 #156050, 12px 8px 0 #105040,
        4px 9px 0 #8bd858, 5px 9px 0 #6bcf6b, 6px 9px 0 #4a9f4a, 7px 9px 0 #3a8f5a, 8px 9px 0 #2a7f5a, 9px 9px 0 #1a6060, 10px 9px 0 #156050, 11px 9px 0 #105040, 12px 9px 0 #0a4030,
        5px 10px 0 #4a9f4a, 6px 10px 0 #3a8f5a, 7px 10px 0 #2a7f5a, 8px 10px 0 #1a6060, 9px 10px 0 #156050, 10px 10px 0 #105040, 11px 10px 0 #0a4030,

        /* Base spread - darkest teal at bottom */
        5px 11px 0 #2a7f5a, 6px 11px 0 #1a6060, 7px 11px 0 #156050, 8px 11px 0 #105040, 9px 11px 0 #0a4030, 10px 11px 0 #0a4030, 11px 11px 0 #053020,
        6px 12px 0 #156050, 7px 12px 0 #105040, 8px 12px 0 #0a4030, 9px 12px 0 #053020, 10px 12px 0 #053020,

        /* Eyes - large and focal, upper-left catchlight */
        5px 6px 0 #ffffff, 6px 6px 0 #ffffff, 6px 7px 0 #ffffff,
        5px 7px 0 #e8e8ff, 7px 7px 0 #1a1a24, 6px 8px 0 #1a1a24,
        9px 6px 0 #ffffff, 10px 6px 0 #f0f0ff,
        9px 7px 0 #e8e8ff, 10px 7px 0 #1a1a24, 9px 8px 0 #1a1a24,

        /* Specular highlight - crisp white on lit side */
        5px 5px 0 #ffffff, 6px 5px 0 #ffffff,

        /* Drip on shaded side only - follows gravity */
        12px 10px 0 #105040, 12px 11px 0 #0a4030, 12px 12px 0 #053020, 12px 13px 0 #053020;
    }

    /* INFERNO - Third enemy, fire demon */
    .inferno-sprite {
      transform: scale(5);
    }

    .inferno-sprite .pixel-sprite {
      box-shadow:
        /* INFERNO - Fierce fire demon, upper-left light */
        /* Palette: Shadow #660000 (dark red) → Mid #ff4400 (orange) → Highlight #ffff88 (yellow-white) */

        /* Flame head/horns */
        6px 2px 0 #ffff88, 10px 2px 0 #ffdd44,
        5px 3px 0 #ffff88, 6px 3px 0 #ffdd44, 10px 3px 0 #ffaa00, 11px 3px 0 #ff6600,
        5px 4px 0 #ffdd44, 6px 4px 0 #ffaa00, 10px 4px 0 #ff6600, 11px 4px 0 #cc3300,

        /* Head - demonic face */
        6px 5px 0 #ffff88, 7px 5px 0 #ffdd44, 8px 5px 0 #ffaa00, 9px 5px 0 #ff6600, 10px 5px 0 #cc3300,
        5px 6px 0 #ffff88, 6px 6px 0 #ffdd44, 7px 6px 0 #ffaa00, 8px 6px 0 #ff6600, 9px 6px 0 #ff4400, 10px 6px 0 #cc3300, 11px 6px 0 #990000,
        5px 7px 0 #ffdd44, 6px 7px 0 #ffaa00, 7px 7px 0 #ff6600, 8px 7px 0 #ff4400, 9px 7px 0 #cc3300, 10px 7px 0 #990000, 11px 7px 0 #660000,
        5px 8px 0 #ffaa00, 6px 8px 0 #ff6600, 7px 8px 0 #ff4400, 8px 8px 0 #cc3300, 9px 8px 0 #990000, 10px 8px 0 #660000, 11px 8px 0 #440000,

        /* Body - torso */
        6px 9px 0 #ff6600, 7px 9px 0 #ff4400, 8px 9px 0 #cc3300, 9px 9px 0 #990000, 10px 9px 0 #660000,
        6px 10px 0 #ff4400, 7px 10px 0 #cc3300, 8px 10px 0 #990000, 9px 10px 0 #660000, 10px 10px 0 #440000,
        7px 11px 0 #990000, 8px 11px 0 #660000, 9px 11px 0 #440000,

        /* Angry eyes - glowing white/yellow */
        6px 6px 0 #ffffff, 7px 6px 0 #ffff88,
        9px 6px 0 #ffffff, 10px 6px 0 #ffff88,
        6px 7px 0 #ffff00, 9px 7px 0 #ffff00,

        /* Mouth - jagged */
        7px 8px 0 #440000, 8px 8px 0 #ffff88, 9px 8px 0 #440000,

        /* Flame wisps around body */
        4px 5px 0 #ffff88, 3px 6px 0 #ffdd44, 4px 7px 0 #ffaa00, 3px 8px 0 #ff6600,
        12px 5px 0 #ffdd44, 13px 6px 0 #ffaa00, 12px 7px 0 #ff6600, 13px 8px 0 #cc3300,
        4px 9px 0 #ff4400, 12px 9px 0 #990000,

        /* Feet/base flames */
        6px 12px 0 #660000, 7px 12px 0 #440000, 9px 12px 0 #440000, 10px 12px 0 #330000,
        5px 13px 0 #ff6600, 6px 13px 0 #cc3300, 10px 13px 0 #660000, 11px 13px 0 #440000;
    }

    /* CRYSTOWL - Geometric ice owl */
    .crystowl-sprite {
      transform: scale(5);
      filter: drop-shadow(0 0 4px #88ddff) drop-shadow(0 0 8px #44aadd);
      animation: crystowl-hover 2s ease-in-out infinite, crystowl-shimmer 3s ease-in-out infinite;
    }

    @keyframes crystowl-hover {
      0%, 100% { transform: scale(5) translateY(0) rotate(-2deg); }
      50% { transform: scale(5) translateY(-6px) rotate(2deg); }
    }

    @keyframes crystowl-shimmer {
      0%, 100% { filter: drop-shadow(0 0 4px #88ddff) drop-shadow(0 0 8px #44aadd) brightness(1); }
      50% { filter: drop-shadow(0 0 8px #aaeeff) drop-shadow(0 0 16px #66ccff) brightness(1.2); }
    }

    .crystowl-sprite .pixel-sprite {
      box-shadow:
        /* CRYSTOWL - Ice crystal owl, upper-left lighting */
        /* Palette: Shadow #2266aa → Mid #44aadd → Highlight #eeffff */

        /* Ear tufts - ice crystal points */
        4px 1px 0 #eeffff, 5px 1px 0 #bbddff,
        12px 1px 0 #88ccff, 13px 1px 0 #44aadd,
        4px 2px 0 #bbddff, 5px 2px 0 #88ccff,
        12px 2px 0 #66bbee, 13px 2px 0 #2266aa,
        5px 3px 0 #88ccff,
        12px 3px 0 #44aadd,

        /* Head - geometric faceted */
        6px 3px 0 #eeffff, 7px 3px 0 #bbddff, 8px 3px 0 #bbddff, 9px 3px 0 #88ccff, 10px 3px 0 #66bbee, 11px 3px 0 #44aadd,
        5px 4px 0 #eeffff, 6px 4px 0 #bbddff, 7px 4px 0 #88ccff, 8px 4px 0 #88ccff, 9px 4px 0 #66bbee, 10px 4px 0 #44aadd, 11px 4px 0 #2266aa, 12px 4px 0 #2266aa,
        5px 5px 0 #bbddff, 6px 5px 0 #88ccff, 7px 5px 0 #66bbee, 8px 5px 0 #66bbee, 9px 5px 0 #44aadd, 10px 5px 0 #44aadd, 11px 5px 0 #2266aa, 12px 5px 0 #1a5588,

        /* Eyes - glowing cyan */
        6px 5px 0 #ffffff, 7px 5px 0 #aaffff,
        10px 5px 0 #88ffff, 11px 5px 0 #44dddd,
        6px 6px 0 #aaffff, 7px 6px 0 #00dddd,
        10px 6px 0 #00bbbb, 11px 6px 0 #008888,

        /* Beak - ice crystal */
        8px 6px 0 #eeffff, 9px 6px 0 #bbddff,
        8px 7px 0 #bbddff, 9px 7px 0 #88ccff,

        /* Lower face */
        5px 6px 0 #88ccff, 12px 6px 0 #2266aa,
        5px 7px 0 #66bbee, 6px 7px 0 #66bbee, 7px 7px 0 #44aadd, 10px 7px 0 #44aadd, 11px 7px 0 #2266aa, 12px 7px 0 #1a5588,

        /* Body - rounded with crystal facets */
        5px 8px 0 #eeffff, 6px 8px 0 #bbddff, 7px 8px 0 #88ccff, 8px 8px 0 #66bbee, 9px 8px 0 #66bbee, 10px 8px 0 #44aadd, 11px 8px 0 #2266aa, 12px 8px 0 #1a5588,
        4px 9px 0 #bbddff, 5px 9px 0 #88ccff, 6px 9px 0 #66bbee, 7px 9px 0 #44aadd, 8px 9px 0 #44aadd, 9px 9px 0 #2266aa, 10px 9px 0 #2266aa, 11px 9px 0 #1a5588, 12px 9px 0 #1a5588,
        4px 10px 0 #88ccff, 5px 10px 0 #66bbee, 6px 10px 0 #44aadd, 7px 10px 0 #2266aa, 8px 10px 0 #2266aa, 9px 10px 0 #1a5588, 10px 10px 0 #1a5588, 11px 10px 0 #104477,

        /* Wings - angular ice shards */
        2px 7px 0 #eeffff, 3px 7px 0 #bbddff,
        2px 8px 0 #bbddff, 3px 8px 0 #88ccff, 4px 8px 0 #66bbee,
        3px 9px 0 #66bbee,
        14px 7px 0 #66bbee, 15px 7px 0 #44aadd,
        13px 8px 0 #44aadd, 14px 8px 0 #2266aa, 15px 8px 0 #1a5588,
        13px 9px 0 #2266aa,

        /* Feet - small ice talons */
        6px 11px 0 #88ccff, 7px 11px 0 #66bbee, 9px 11px 0 #44aadd, 10px 11px 0 #2266aa,
        6px 12px 0 #44aadd, 10px 12px 0 #1a5588;
    }

    /* MOLDSPORE - Toxic mushroom creature (enhanced) */
    .moldspore-sprite {
      transform: scale(5);
      animation: moldspore-breathe 2.5s ease-in-out infinite, moldspore-toxic 4s ease-in-out infinite;
    }

    @keyframes moldspore-breathe {
      0%, 100% { transform: scale(5) scaleY(1); }
      50% { transform: scale(5) scaleY(1.06) scaleX(0.97); }
    }

    @keyframes moldspore-toxic {
      0%, 100% { filter: hue-rotate(0deg) brightness(1) drop-shadow(0 0 2px #aa66cc); }
      25% { filter: hue-rotate(15deg) brightness(1.15) drop-shadow(0 0 4px #cc88ee); }
      50% { filter: hue-rotate(0deg) brightness(1.05) drop-shadow(0 0 3px #bb77dd); }
      75% { filter: hue-rotate(-15deg) brightness(0.9) drop-shadow(0 0 2px #8844aa); }
    }

    .moldspore-sprite .pixel-sprite {
      box-shadow:
        /* MOLDSPORE - Poison mushroom, upper-left lighting */
        /* Enhanced palette with more depth */

        /* Mushroom cap - larger, more bulbous with rim light */
        7px 0px 0 #eeccff, 8px 0px 0 #ddbbee, 9px 0px 0 #ccaadd,
        5px 1px 0 #eeccff, 6px 1px 0 #ddaaff, 7px 1px 0 #cc99ee, 8px 1px 0 #bb88dd, 9px 1px 0 #aa77cc, 10px 1px 0 #9966bb, 11px 1px 0 #8855aa,
        4px 2px 0 #eeccff, 5px 2px 0 #ddaaff, 6px 2px 0 #cc88ee, 7px 2px 0 #bb77dd, 8px 2px 0 #aa66cc, 9px 2px 0 #9955bb, 10px 2px 0 #8844aa, 11px 2px 0 #773399, 12px 2px 0 #662288,
        3px 3px 0 #ddbbee, 4px 3px 0 #ddaaff, 5px 3px 0 #cc88ee, 6px 3px 0 #bb77dd, 7px 3px 0 #aa66cc, 8px 3px 0 #9955bb, 9px 3px 0 #8844aa, 10px 3px 0 #773399, 11px 3px 0 #662288, 12px 3px 0 #551177, 13px 3px 0 #440066,
        3px 4px 0 #ccaadd, 4px 4px 0 #cc88ee, 5px 4px 0 #bb77dd, 6px 4px 0 #aa66cc, 7px 4px 0 #9955bb, 8px 4px 0 #8844aa, 9px 4px 0 #773399, 10px 4px 0 #662288, 11px 4px 0 #551177, 12px 4px 0 #440066, 13px 4px 0 #330055,
        3px 5px 0 #bb99cc, 4px 5px 0 #bb77dd, 5px 5px 0 #aa66cc, 6px 5px 0 #9955bb, 7px 5px 0 #8844aa, 8px 5px 0 #773399, 9px 5px 0 #662288, 10px 5px 0 #551177, 11px 5px 0 #440066, 12px 5px 0 #330055, 13px 5px 0 #220044,
        4px 6px 0 #aa88bb, 5px 6px 0 #9955bb, 6px 6px 0 #8844aa, 7px 6px 0 #773399, 8px 6px 0 #662288, 9px 6px 0 #551177, 10px 6px 0 #440066, 11px 6px 0 #330055, 12px 6px 0 #220044,

        /* Cap underside - gills with darker shading */
        5px 7px 0 #553366, 6px 7px 0 #664477, 7px 7px 0 #553366, 8px 7px 0 #664477, 9px 7px 0 #553366, 10px 7px 0 #664477, 11px 7px 0 #553366,

        /* Glowing toxic spots on cap - larger, brighter */
        6px 2px 0 #ffeeFF, 7px 2px 0 #ffddf8,
        10px 3px 0 #ffeeff, 11px 3px 0 #eeddff,
        5px 4px 0 #ffddff, 6px 4px 0 #ffeeff,
        9px 5px 0 #eeccff, 10px 5px 0 #ffeeff,
        7px 3px 0 #ffeeff,

        /* Eyes - larger, more menacing with catchlights */
        5px 5px 0 #88ff00, 6px 5px 0 #aaff33, 7px 5px 0 #111100,
        10px 5px 0 #77dd00, 11px 5px 0 #99ee22, 12px 5px 0 #111100,
        6px 6px 0 #66cc00, 11px 6px 0 #55aa00,

        /* Stem - textured with vertical striations */
        6px 8px 0 #bbeeaa, 7px 8px 0 #aadd99, 8px 8px 0 #99cc88, 9px 8px 0 #88bb77, 10px 8px 0 #77aa66,
        6px 9px 0 #aadd99, 7px 9px 0 #88cc77, 8px 9px 0 #99bb88, 9px 9px 0 #77aa66, 10px 9px 0 #669955,
        6px 10px 0 #99cc88, 7px 10px 0 #77bb66, 8px 10px 0 #88aa77, 9px 10px 0 #669955, 10px 10px 0 #558844,
        7px 11px 0 #77aa66, 8px 11px 0 #669955, 9px 11px 0 #558844,

        /* Toxic drip drops hanging from cap */
        4px 7px 0 #bb77dd, 4px 8px 0 #aa66cc, 4px 9px 0 #9955bb,
        12px 7px 0 #9955bb, 12px 8px 0 #8844aa,
        8px 7px 0 #773399, 8px 8px 0 #662288,

        /* Mycelium roots at base */
        5px 12px 0 #558844, 6px 12px 0 #669955, 10px 12px 0 #558844, 11px 12px 0 #448833,
        4px 13px 0 #448833, 7px 13px 0 #558844, 9px 13px 0 #448833, 12px 13px 0 #337722,
        3px 14px 0 #337722, 8px 14px 0 #448833, 13px 14px 0 #226611,

        /* Floating spore particles - more and varied sizes */
        2px 2px 0 #eeccff, 14px 1px 0 #ddbbee, 15px 4px 0 #ccaadd,
        1px 5px 0 #bb99cc, 15px 7px 0 #aa88bb, 0px 8px 0 #ddaaff,
        2px 10px 0 #99dd88, 14px 9px 0 #88cc77, 16px 6px 0 #aa66cc,
        1px 12px 0 #77bb66, 15px 11px 0 #669955,
        3px 7px 0 #cc88ee, 13px 8px 0 #bb77dd;
    }

    /* Drip animation overlay for Moldspore */
    .moldspore-sprite::after {
      content: '';
      position: absolute;
      width: 1px;
      height: 1px;
      transform: scale(5);
      animation: moldspore-drip 2s ease-in infinite;
      box-shadow:
        4px 10px 0 #9955bb,
        12px 9px 0 #8844aa;
    }

    @keyframes moldspore-drip {
      0%, 100% { opacity: 1; transform: scale(5) translateY(0); }
      50% { opacity: 0.8; transform: scale(5) translateY(2px); }
      80% { opacity: 0.4; transform: scale(5) translateY(4px); }
      95% { opacity: 0; transform: scale(5) translateY(6px); }
    }

    /* TRAINER GHOST - Ghostly human trainer */
    .trainer-ghost-sprite {
      transform: scale(4);
      filter: drop-shadow(0 0 3px #9966ff) drop-shadow(0 0 6px #7744dd) drop-shadow(0 0 12px #5522bb);
      animation: ghost-float 2.5s ease-in-out infinite, ghost-flicker 4s ease-in-out infinite;
    }

    @keyframes ghost-float {
      0%, 100% { transform: scale(4) translateY(0); }
      50% { transform: scale(4) translateY(-5px); }
    }

    @keyframes ghost-flicker {
      0%, 100% { opacity: 0.95; }
      50% { opacity: 0.85; }
      52%, 54% { opacity: 0.6; }
    }

    .trainer-ghost-sprite .pixel-sprite {
      box-shadow:
        /* TRAINER GHOST - Detailed human trainer, spectral purple tones */
        /* Upper-left lighting, hue-shifted purples */

        /* Hair - flowing messy ghostly hair with highlights */
        5px 0px 0 #5a4a7a, 6px 0px 0 #6a5a8a, 7px 0px 0 #7a6a9a, 9px 0px 0 #6a5a8a, 11px 0px 0 #5a4a7a,
        4px 1px 0 #4a3a6a, 5px 1px 0 #7a6a9a, 6px 1px 0 #9a8aba, 7px 1px 0 #b8a8d8, 8px 1px 0 #9a8aba, 9px 1px 0 #8a7aaa, 10px 1px 0 #7a6a9a, 11px 1px 0 #5a4a7a, 12px 1px 0 #4a3a6a,
        4px 2px 0 #5a4a7a, 5px 2px 0 #8a7aaa, 6px 2px 0 #b8a8d8, 7px 2px 0 #c8b8e8, 8px 2px 0 #b8a8d8, 9px 2px 0 #9a8aba, 10px 2px 0 #8a7aaa, 11px 2px 0 #6a5a8a, 12px 2px 0 #4a3a6a,
        4px 3px 0 #6a5a8a, 5px 3px 0 #9a8aba, 6px 3px 0 #b8a8d8, 7px 3px 0 #b8a8d8, 8px 3px 0 #9a8aba, 9px 3px 0 #8a7aaa, 10px 3px 0 #7a6a9a, 11px 3px 0 #5a4a7a, 12px 3px 0 #3a2a5a,

        /* Forehead - pale ghostly with highlight */
        5px 4px 0 #8a7aaa, 6px 4px 0 #e8d8f8, 7px 4px 0 #f8e8ff, 8px 4px 0 #f8e8ff, 9px 4px 0 #e8d8f8, 10px 4px 0 #d8c8e8, 11px 4px 0 #7a6a9a,

        /* Eyes row - detailed with brows and catchlights */
        5px 5px 0 #c8b8d8, 6px 5px 0 #5a4a7a, 7px 5px 0 #e8d8f8, 8px 5px 0 #f8e8ff, 9px 5px 0 #e8d8f8, 10px 5px 0 #5a4a7a, 11px 5px 0 #b8a8c8,
        5px 6px 0 #d8c8e8, 6px 6px 0 #1a0a3a, 7px 6px 0 #e8d8f8, 8px 6px 0 #e8d8f8, 9px 6px 0 #e8d8f8, 10px 6px 0 #1a0a3a, 11px 6px 0 #c8b8d8,
        /* Eye glow */
        6px 6px 0 #cc66ff, 10px 6px 0 #aa44ff,
        6px 5px 0 #ffffff, 10px 5px 0 #ffaaff,

        /* Nose and cheeks */
        5px 7px 0 #d8c8e8, 6px 7px 0 #e8d8f8, 7px 7px 0 #f8e8ff, 8px 7px 0 #e8d8f8, 9px 7px 0 #e8d8f8, 10px 7px 0 #d8c8e8, 11px 7px 0 #c8b8d8,
        8px 7px 0 #d8c8e8,

        /* Mouth - confident smirk */
        5px 8px 0 #c8b8d8, 6px 8px 0 #d8c8e8, 7px 8px 0 #9a7aaa, 8px 8px 0 #7a5a8a, 9px 8px 0 #9a7aaa, 10px 8px 0 #c8b8d8, 11px 8px 0 #b8a8c8,

        /* Chin and jaw */
        6px 9px 0 #c8b8d8, 7px 9px 0 #d8c8e8, 8px 9px 0 #d8c8e8, 9px 9px 0 #c8b8d8, 10px 9px 0 #b8a8c8,

        /* Neck */
        7px 10px 0 #b8a8c8, 8px 10px 0 #c8b8d8, 9px 10px 0 #b8a8c8,

        /* High collar - detailed with folds */
        4px 11px 0 #2a1a4a, 5px 11px 0 #4a3a6a, 6px 11px 0 #5a4a7a, 7px 11px 0 #6a5a8a, 8px 11px 0 #6a5a8a, 9px 11px 0 #5a4a7a, 10px 11px 0 #4a3a6a, 11px 11px 0 #3a2a5a, 12px 11px 0 #2a1a4a,
        4px 12px 0 #3a2a5a, 5px 12px 0 #5a4a7a, 6px 12px 0 #6a5a8a, 7px 12px 0 #7a6a9a, 8px 12px 0 #7a6a9a, 9px 12px 0 #6a5a8a, 10px 12px 0 #5a4a7a, 11px 12px 0 #4a3a6a, 12px 12px 0 #2a1a4a,

        /* Coat body with lapels and shading */
        3px 13px 0 #1a0a3a, 4px 13px 0 #3a2a5a, 5px 13px 0 #5a4a7a, 6px 13px 0 #6a5a8a, 7px 13px 0 #7a6a9a, 8px 13px 0 #7a6a9a, 9px 13px 0 #6a5a8a, 10px 13px 0 #5a4a7a, 11px 13px 0 #4a3a6a, 12px 13px 0 #2a1a4a, 13px 13px 0 #1a0a3a,
        3px 14px 0 #2a1a4a, 4px 14px 0 #4a3a6a, 5px 14px 0 #6a5a8a, 6px 14px 0 #7a6a9a, 7px 14px 0 #8a7aaa, 8px 14px 0 #8a7aaa, 9px 14px 0 #7a6a9a, 10px 14px 0 #6a5a8a, 11px 14px 0 #4a3a6a, 12px 14px 0 #3a2a5a, 13px 14px 0 #1a0a3a,
        3px 15px 0 #2a1a4a, 4px 15px 0 #4a3a6a, 5px 15px 0 #6a5a8a, 6px 15px 0 #7a6a9a, 7px 15px 0 #7a6a9a, 8px 15px 0 #7a6a9a, 9px 15px 0 #6a5a8a, 10px 15px 0 #5a4a7a, 11px 15px 0 #4a3a6a, 12px 15px 0 #2a1a4a, 13px 15px 0 #1a0a3a,
        3px 16px 0 #1a0a3a, 4px 16px 0 #3a2a5a, 5px 16px 0 #5a4a7a, 6px 16px 0 #6a5a8a, 7px 16px 0 #6a5a8a, 8px 16px 0 #6a5a8a, 9px 16px 0 #5a4a7a, 10px 16px 0 #4a3a6a, 11px 16px 0 #3a2a5a, 12px 16px 0 #1a0a3a, 13px 16px 0 #0a0020,

        /* Glowing coat buttons */
        8px 13px 0 #bb88ff, 8px 14px 0 #aa66ff, 8px 15px 0 #9955ee,

        /* Arms/sleeves */
        2px 14px 0 #c8b8d8, 2px 15px 0 #d8c8e8, 3px 15px 0 #c8b8d8,
        14px 14px 0 #b8a8c8, 14px 15px 0 #c8b8d8,

        /* Hands - ghostly pale */
        2px 16px 0 #e8d8f8, 2px 17px 0 #d8c8e8,
        14px 16px 0 #d8c8e8, 14px 17px 0 #c8b8d8,

        /* Coat tails / lower body fading */
        4px 17px 0 #2a1a4a, 5px 17px 0 #3a2a5a, 6px 17px 0 #4a3a6a, 7px 17px 0 #4a3a6a, 9px 17px 0 #4a3a6a, 10px 17px 0 #3a2a5a, 11px 17px 0 #2a1a4a, 12px 17px 0 #1a0a3a,
        5px 18px 0 #2a1a4a, 6px 18px 0 #3a2a5a, 7px 18px 0 #3a2a5a, 9px 18px 0 #3a2a5a, 10px 18px 0 #2a1a4a, 11px 18px 0 #1a0a3a,
        5px 19px 0 #1a0a3a, 6px 19px 0 #2a1a4a, 10px 19px 0 #1a0a3a, 11px 19px 0 #0a0020,

        /* Ghostly wisps dissolving */
        4px 20px 0 #1a0a3a, 6px 20px 0 #1a0a3a, 8px 20px 0 #2a1a4a, 10px 20px 0 #1a0a3a, 12px 20px 0 #0a0020,
        5px 21px 0 #0a0020, 7px 21px 0 #1a0a3a, 9px 21px 0 #0a0020, 11px 21px 0 #0a0020,
        6px 22px 0 #0a0020, 8px 22px 0 #0a0020, 10px 22px 0 #0a0020;
    }

    /* Trainer appear overlay */
    .trainer-overlay {
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 32%;
      background: rgba(0, 0, 0, 0.6);
      z-index: 55;
    }

    .trainer-sprite-container {
      position: absolute;
      top: 22%;
      right: 18%;
      transform: translateX(50%);
    }

    /* Ending screen */
    .ending-screen {
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: linear-gradient(180deg, #98d8a0 0%, #68a870 100%);
      z-index: 60;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      animation: fade-in 1s ease-out;
    }

    @keyframes fade-in {
      from { opacity: 0; }
      to { opacity: 1; }
    }

    .ending-logo {
      font-family: 'Press Start 2P', cursive;
      font-size: 28px;
      color: #2a4a2a;
      text-shadow: 2px 2px 0 #1a3a1a, -1px -1px 0 #4a6a4a;
      margin-bottom: 8px;
      letter-spacing: 2px;
    }

    .ending-logo-sub {
      font-family: 'Press Start 2P', cursive;
      font-size: 10px;
      color: #c8483c;
      letter-spacing: 4px;
      margin-bottom: 40px;
    }

    .ending-sprite {
      margin-bottom: 30px;
    }

    .ending-text {
      font-family: 'Press Start 2P', cursive;
      font-size: 10px;
      color: #2a4a2a;
      margin-bottom: 20px;
      text-align: center;
      line-height: 1.8;
    }

    .ending-links {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 8px;
    }

    .ending-links a {
      font-family: 'Press Start 2P', cursive;
      font-size: 9px;
      color: #1a3a1a;
      text-decoration: none;
    }

    .ending-links a:hover {
      color: #c8483c;
    }

    .play-again-btn {
      margin-top: 20px;
      padding: 12px 24px;
      background: linear-gradient(180deg, #f8f0d8 0%, #e8e0c8 100%);
      border: 3px solid #484038;
      border-radius: 8px;
      font-family: 'Press Start 2P', cursive;
      font-size: 12px;
      color: #303030;
      cursor: pointer;
      transition: all 0.15s;
    }

    .play-again-btn:hover {
      background: linear-gradient(180deg, #fff8e8 0%, #f8f0d8 100%);
      transform: scale(1.05);
    }

    .play-again-btn:active {
      transform: scale(0.98);
    }

    /* 3D End Screen */
    #three-container {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      z-index: 1000;
      background: linear-gradient(180deg, #2a1a0a 0%, #1a0a00 100%);
    }

    /* Cinematic vignette overlay */
    .ending-vignette {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      z-index: 1000;
      pointer-events: none;
      background: radial-gradient(ellipse at center,
        transparent 0%,
        transparent 40%,
        rgba(10,5,0,0.3) 60%,
        rgba(10,5,0,0.6) 80%,
        rgba(10,5,0,0.85) 100%
      );
      opacity: 0;
      animation: fadeInVignette 2s ease-out 1s forwards;
    }

    @keyframes fadeInVignette {
      to { opacity: 1; }
    }

    .ending-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      z-index: 1001;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: flex-start;
      padding-top: 4%;
      pointer-events: none;
      opacity: 0;
      animation: fadeInOverlay 1.5s ease-out 2.5s forwards;
    }

    @keyframes fadeInOverlay {
      to { opacity: 1; }
    }

    .ending-overlay .ending-text {
      font-family: 'Press Start 2P', cursive;
      font-size: clamp(12px, 3vw, 18px);
      color: #f8f0d8;
      text-shadow: 0 0 20px rgba(255,200,100,0.4), 2px 2px 8px rgba(0,0,0,0.9);
      margin-bottom: 12px;
      letter-spacing: 1px;
    }

    .ending-overlay .ending-links {
      display: flex;
      flex-direction: row;
      align-items: center;
      gap: clamp(15px, 4vw, 40px);
      margin-bottom: 15px;
      flex-wrap: wrap;
      justify-content: center;
    }

    .ending-overlay .ending-links a {
      font-family: 'Press Start 2P', cursive;
      font-size: clamp(8px, 2vw, 11px);
      color: #c8a868;
      text-decoration: none;
      pointer-events: auto;
      text-shadow: 0 0 10px rgba(200,168,104,0.3), 1px 1px 4px rgba(0,0,0,0.8);
      padding: 8px 12px;
      transition: color 0.2s, text-shadow 0.2s;
    }

    .ending-overlay .ending-links a:hover {
      color: #f8d888;
      text-shadow: 0 0 15px rgba(248,216,136,0.5), 1px 1px 4px rgba(0,0,0,0.8);
    }

    .ending-overlay .play-again-btn {
      pointer-events: auto;
      padding: clamp(12px, 3vw, 18px) clamp(24px, 6vw, 40px);
      background: linear-gradient(180deg, #5a4a3a 0%, #3a2a1a 100%);
      border: 3px solid #7a6a5a;
      border-radius: 8px;
      font-family: 'Press Start 2P', cursive;
      font-size: clamp(11px, 2.5vw, 14px);
      color: #f8f0d8;
      cursor: pointer;
      transition: all 0.15s;
      -webkit-tap-highlight-color: transparent;
      touch-action: manipulation;
      box-shadow: 0 4px 15px rgba(0,0,0,0.5), inset 0 1px 0 rgba(255,255,255,0.1);
    }

    .ending-overlay .play-again-btn:hover,
    .ending-overlay .play-again-btn:active {
      background: linear-gradient(180deg, #6a5a4a 0%, #4a3a2a 100%);
      transform: scale(1.05);
      box-shadow: 0 6px 20px rgba(0,0,0,0.6), inset 0 1px 0 rgba(255,255,255,0.15);
    }

    .ending-overlay .zoom-hint {
      position: absolute;
      bottom: 20px;
      font-family: 'Press Start 2P', cursive;
      font-size: 8px;
      color: rgba(200,168,104,0.4);
      text-shadow: 1px 1px 4px rgba(0,0,0,0.8);
    }

    /* Mobile adjustments for ending screen */
    @media (max-width: 480px) {
      .ending-overlay {
        padding-top: 3%;
      }
      .ending-overlay .ending-links {
        flex-direction: column;
        gap: 8px;
      }
    }

    /* EXP bar */
    .exp-bar-container {
      position: absolute;
      bottom: 34%;
      right: 2%;
      width: 44%;
      z-index: 21;
    }

    .exp-bar-bg {
      height: 6px;
      background: #484038;
      border-radius: 3px;
      overflow: hidden;
    }

    .exp-bar-inner {
      height: 100%;
      background: linear-gradient(180deg, #58c8f8 0%, #2090c8 100%);
      width: 0%;
      transition: width 1s ease-out;
    }

    /* Faint animation */
    @keyframes faintDrop {
      0% { transform: translateY(0) scaleX(-1); opacity: 1; }
      100% { transform: translateY(60px) scaleX(-1); opacity: 0; }
    }

    .creature-enemy.fainting {
      animation: faintDrop 0.8s ease-in forwards !important;
    }

    /* Appear animation */
    @keyframes appearPop {
      0% { transform: scale(0) scaleX(-1); opacity: 0; }
      50% { transform: scale(1.2) scaleX(-1); }
      100% { transform: scale(1) scaleX(-1); opacity: 1; }
    }

    .creature-enemy.appearing {
      animation: appearPop 0.5s ease-out forwards !important;
    }

    /* Creature animations */
    @keyframes creatureBounce {
      0%, 100% { transform: translateY(0); }
      50% { transform: translateY(-6px); }
    }

    @keyframes enemyFloat {
      0%, 100% { transform: translateY(0) scaleX(-1); }
      50% { transform: translateY(-8px) scaleX(-1); }
    }

    .creature-player { animation: creatureBounce 1s ease-in-out infinite; }
    .creature-enemy { animation: enemyFloat 1.5s ease-in-out infinite; }

    /* Attack flash */
    @keyframes hitFlash {
      0%, 100% { filter: brightness(1); }
      50% { filter: brightness(3) saturate(0); }
    }

    .creature.hit {
      animation: hitFlash 0.1s ease-in-out 4 !important;
    }

    /* Bottom battle panel - FireRed style */
    .battle-panel {
      position: absolute;
      bottom: 0;
      left: 0;
      right: 0;
      height: 32%;
      background: #78c850;
      border-top: 4px solid #484038;
      display: flex;
      z-index: 30;
    }

    .message-box {
      flex: 1;
      background: #f8f8f8;
      border: 4px solid #484038;
      border-radius: 10px;
      margin: 8px;
      padding: 12px 14px;
      display: flex;
      align-items: flex-start;
    }

    .message-text {
      font-size: 15px;
      color: #303030;
      line-height: 1.6;
    }

    /* Pokemon-style announcement textbox */
    .announce-box {
      position: absolute;
      bottom: 0;
      left: 0;
      right: 0;
      background: #f8f8f8;
      border: 4px solid #484038;
      border-radius: 12px 12px 0 0;
      padding: 16px 20px;
      z-index: 60;
      min-height: 70px;
      display: none;
    }

    .announce-box.visible {
      display: block;
    }

    .announce-text {
      font-size: 18px;
      color: #303030;
      line-height: 1.5;
      font-family: 'Pokemon GB', monospace;
    }

    .announce-box::after {
      content: '▼';
      position: absolute;
      bottom: 8px;
      right: 12px;
      font-size: 12px;
      color: #484038;
      animation: bounce-arrow 0.6s ease-in-out infinite;
    }

    @keyframes bounce-arrow {
      0%, 100% { transform: translateY(0); }
      50% { transform: translateY(3px); }
    }

    .action-box {
      width: 46%;
      background: #f8f8f8;
      border: 4px solid #484038;
      border-radius: 10px;
      margin: 8px;
      padding: 8px 12px;
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 0;
      align-items: center;
    }

    .action-btn {
      font-family: 'Press Start 2P', cursive;
      font-size: 13px;
      padding: 10px 4px 10px 22px;
      background: transparent;
      border: none;
      color: #303030;
      cursor: pointer;
      text-align: left;
      position: relative;
      white-space: nowrap;
    }

    .action-btn::before {
      content: '▶';
      position: absolute;
      left: 4px;
      opacity: 0;
      font-size: 10px;
      transition: opacity 0.1s;
    }

    .action-btn:hover::before,
    .action-btn:active::before,
    .action-btn.selected::before { opacity: 1; }

    .action-btn.selected {
      background: rgba(0,0,0,0.05);
    }

    /* Fight panel - FireRed style */
    .fight-panel {
      position: absolute;
      bottom: 0;
      left: 0;
      right: 0;
      height: 32%;
      background: #78c850;
      border-top: 4px solid #484038;
      display: none;
      z-index: 31;
    }

    .fight-panel.active { display: flex; }

    .moves-box {
      flex: 1;
      background: #f8f8f8;
      border: 4px solid #484038;
      border-radius: 10px;
      margin: 8px;
      display: grid;
      grid-template-columns: 1fr 1fr;
      grid-template-rows: 1fr 1fr;
      padding: 8px;
      align-items: center;
    }

    .move-btn {
      font-family: 'Press Start 2P', cursive;
      font-size: 12px;
      padding: 8px 4px 8px 22px;
      background: transparent;
      border: none;
      color: #303030;
      cursor: pointer;
      text-align: left;
      position: relative;
      white-space: nowrap;
    }

    .move-btn::before {
      content: '▶';
      position: absolute;
      left: 4px;
      opacity: 0;
      font-size: 9px;
      transition: opacity 0.1s;
    }

    .move-btn:hover::before,
    .move-btn:active::before,
    .move-btn.selected::before { opacity: 1; }

    .move-btn.selected {
      background: rgba(0,0,0,0.05);
    }

    .move-info {
      width: 32%;
      background: #f8f8f8;
      border: 4px solid #484038;
      border-radius: 10px;
      margin: 8px;
      padding: 12px;
      font-size: 12px;
      color: #303030;
      line-height: 1.8;
    }

    /* Items panel - FireRed style */
    .items-panel {
      position: absolute;
      bottom: 0;
      left: 0;
      right: 0;
      height: 32%;
      background: #78c850;
      border-top: 4px solid #484038;
      display: none;
      z-index: 31;
    }

    .items-panel.active { display: flex; }

    .items-list {
      flex: 1;
      background: #f8f8f8;
      border: 4px solid #484038;
      border-radius: 10px;
      margin: 8px;
      padding: 10px;
      display: flex;
      flex-direction: column;
      gap: 2px;
    }

    .item-btn {
      font-family: 'Press Start 2P', cursive;
      font-size: 12px;
      padding: 10px 4px 10px 22px;
      background: transparent;
      border: none;
      color: #303030;
      cursor: pointer;
      text-align: left;
      position: relative;
      display: flex;
      justify-content: space-between;
    }

    .item-btn::before {
      content: '▶';
      position: absolute;
      left: 4px;
      opacity: 0;
      font-size: 9px;
      transition: opacity 0.1s;
    }

    .item-btn:hover::before,
    .item-btn:active::before,
    .item-btn.selected::before { opacity: 1; }

    .item-btn.selected {
      background: rgba(0,0,0,0.05);
    }

    .item-count { color: #606060; }

    /* BACK button in items menu needs spacing */
    .item-btn[data-item="cancel"] {
      margin-top: 6px;
      padding-top: 8px;
      border-top: 1px solid rgba(0,0,0,0.1);
    }

    /* PARTICLE SYSTEMS */
    .particle {
      position: absolute;
      pointer-events: none;
      z-index: 45;
    }

    /* Fire particles - teardrop wisps */
    .fire-particle {
      width: 8px;
      height: 12px;
      background: linear-gradient(180deg, #fff8e0 0%, #ffd23f 40%, #ff6b35 80%, transparent 100%);
      border-radius: 50% 50% 50% 50% / 60% 60% 40% 40%;
      animation: fireWisp 0.6s ease-out forwards;
    }

    @keyframes fireWisp {
      0% { opacity: 1; transform: scale(1) translateY(0) rotate(0deg); }
      100% { opacity: 0; transform: scale(0.2) translateY(-35px) rotate(var(--rot, 30deg)); }
    }

    /* Ember particles - sparks that scatter */
    .ember-particle {
      width: 4px;
      height: 8px;
      background: linear-gradient(180deg, #fff8e0 0%, #ffd23f 50%, #ff6b35 100%);
      border-radius: 50% 50% 20% 20%;
      box-shadow: 0 0 6px #ff6b35, 0 0 12px #ffd23f;
      animation: emberSpark 0.5s ease-out forwards;
    }

    @keyframes emberSpark {
      0% { opacity: 1; transform: scale(1) translateY(0) rotate(0deg); }
      50% { opacity: 1; }
      100% { opacity: 0; transform: scale(0.3) translateY(-25px) translateX(var(--dx)) rotate(180deg); }
    }

    /* Flamethrower stream particles */
    .flame-stream-particle {
      width: 16px;
      height: 10px;
      background: linear-gradient(90deg, #cc3300 0%, #ff6b35 30%, #ffd23f 60%, #fff 100%);
      border-radius: 30% 70% 70% 30% / 50%;
      box-shadow: 0 0 15px #ff6b35, 0 0 30px #f7931e;
      animation: flameStreamParticle 0.4s ease-out forwards;
    }

    @keyframes flameStreamParticle {
      0% { opacity: 1; transform: scale(1.2) scaleX(1.5); }
      100% { opacity: 0; transform: scale(0.3) scaleX(0.5) translateY(-10px); }
    }

    /* Shadow Ball */
    .shadow-particle {
      width: 12px;
      height: 12px;
      background: radial-gradient(circle, #e0aaff 0%, #9d4edd 40%, #7b2cbf 70%, #3c096c 100%);
      border-radius: 50%;
      box-shadow: 0 0 10px #9d4edd, 0 0 20px #7b2cbf;
      animation: shadowPulse 0.5s ease-out forwards;
    }

    @keyframes shadowPulse {
      0% { opacity: 1; transform: scale(1); filter: brightness(1); }
      50% { filter: brightness(1.5); }
      100% { opacity: 0; transform: scale(0.2); }
    }

    /* Crunch - dark bite impact */
    .crunch-particle {
      width: 14px;
      height: 14px;
      background: linear-gradient(135deg, #2a1a0a 0%, #4a3020 50%, #1a0a00 100%);
      clip-path: polygon(50% 0%, 100% 50%, 50% 100%, 0% 50%);
      box-shadow: 0 0 8px #4a3020, 0 0 15px #2a1a0a;
      animation: crunchBite 0.4s ease-out forwards;
    }

    @keyframes crunchBite {
      0% { opacity: 1; transform: scale(1.5) rotate(0deg); }
      30% { transform: scale(2) rotate(45deg); }
      100% { opacity: 0; transform: scale(0.3) rotate(90deg) translateY(-15px); }
    }

    /* Fire Blast - explosive star bursts */
    .blast-particle {
      width: 28px;
      height: 28px;
      background: radial-gradient(circle, #fff 0%, #ffd23f 25%, #ff6b35 50%, #cc3300 75%, #660000 100%);
      clip-path: polygon(50% 0%, 65% 35%, 100% 50%, 65% 65%, 50% 100%, 35% 65%, 0% 50%, 35% 35%);
      box-shadow: 0 0 30px #ff6b35, 0 0 60px #f7931e;
      animation: blastExplode 0.7s ease-out forwards;
    }

    @keyframes blastExplode {
      0% { opacity: 1; transform: scale(0.3) rotate(0deg); }
      30% { transform: scale(2.5) rotate(45deg); }
      100% { opacity: 0; transform: scale(0.5) rotate(90deg); }
    }

    /* Void attack */
    .void-particle {
      width: 10px;
      height: 10px;
      background: radial-gradient(circle, #c77dff 0%, #7b2cbf 60%, #240046 100%);
      border-radius: 50%;
      box-shadow: 0 0 8px #9d4edd;
      animation: voidWisp 0.5s ease-out forwards;
    }

    @keyframes voidWisp {
      0% { opacity: 1; transform: scale(1) rotate(0deg); }
      100% { opacity: 0; transform: scale(0.3) rotate(180deg) translateY(20px); }
    }

    /* Ice shard particles - CRYSTOWL */
    .ice-particle {
      width: 6px;
      height: 14px;
      background: linear-gradient(180deg, #ffffff 0%, #aaeeff 30%, #44aadd 70%, #2266aa 100%);
      clip-path: polygon(50% 0%, 100% 100%, 0% 100%);
      box-shadow: 0 0 8px #88ddff, 0 0 16px #44aadd;
      animation: iceShard 0.6s ease-out forwards;
    }

    @keyframes iceShard {
      0% { opacity: 1; transform: scale(1) rotate(0deg) translateY(0); }
      50% { opacity: 1; transform: scale(1.3) rotate(180deg) translateY(-15px); }
      100% { opacity: 0; transform: scale(0.5) rotate(360deg) translateY(-30px); }
    }

    /* Spore particles - MOLDSPORE */
    .spore-particle {
      width: 8px;
      height: 8px;
      background: radial-gradient(circle, #ddaaff 0%, #aa66cc 50%, #773399 100%);
      border-radius: 50%;
      box-shadow: 0 0 6px #bb77dd, 0 0 12px #8844aa;
      animation: sporeDrift 1s ease-out forwards;
    }

    @keyframes sporeDrift {
      0% { opacity: 0.8; transform: scale(0.5) translateY(0) translateX(0); }
      30% { opacity: 1; transform: scale(1.2) translateY(-10px) translateX(var(--dx, 5px)); }
      100% { opacity: 0; transform: scale(0.3) translateY(-40px) translateX(calc(var(--dx, 5px) * 2)); }
    }

    /* Ice attack shader - screen freeze effect */
    .viewport.ice-attack {
      animation: iceShader 0.4s ease-out;
    }

    @keyframes iceShader {
      0% { filter: brightness(1) saturate(1) hue-rotate(0deg); }
      30% { filter: brightness(1.4) saturate(0.5) hue-rotate(-30deg); }
      60% { filter: brightness(1.2) saturate(0.8) hue-rotate(-15deg) contrast(1.1); }
      100% { filter: brightness(1) saturate(1) hue-rotate(0deg); }
    }

    .viewport.ice-attack::after {
      content: '';
      position: absolute;
      inset: 0;
      background: radial-gradient(circle at 50% 50%, transparent 30%, rgba(136, 221, 255, 0.3) 100%);
      animation: iceFrost 0.4s ease-out;
      pointer-events: none;
      z-index: 100;
    }

    @keyframes iceFrost {
      0% { opacity: 0; }
      40% { opacity: 1; }
      100% { opacity: 0; }
    }

    /* Toxic spore shader - poison cloud effect */
    .viewport.toxic-attack {
      animation: toxicShader 0.5s ease-out;
    }

    @keyframes toxicShader {
      0% { filter: brightness(1) saturate(1) hue-rotate(0deg); }
      25% { filter: brightness(0.9) saturate(1.3) hue-rotate(60deg); }
      50% { filter: brightness(0.85) saturate(1.5) hue-rotate(90deg) blur(1px); }
      100% { filter: brightness(1) saturate(1) hue-rotate(0deg) blur(0px); }
    }

    .viewport.toxic-attack::after {
      content: '';
      position: absolute;
      inset: 0;
      background: radial-gradient(circle at 50% 50%, rgba(170, 102, 204, 0.4) 0%, rgba(119, 51, 153, 0.2) 50%, transparent 70%);
      animation: toxicCloud 0.5s ease-out;
      pointer-events: none;
      z-index: 100;
    }

    @keyframes toxicCloud {
      0% { opacity: 0; transform: scale(0.5); }
      40% { opacity: 1; transform: scale(1.2); }
      100% { opacity: 0; transform: scale(1.5); }
    }

    /* Spectre attack shader - ghostly wisp effect */
    .viewport.spectre-attack {
      animation: spectreShader 0.5s ease-out;
    }

    @keyframes spectreShader {
      0% { filter: brightness(1) saturate(1) hue-rotate(0deg); }
      25% { filter: brightness(0.7) saturate(0.6) hue-rotate(-20deg) blur(1px); }
      50% { filter: brightness(0.5) saturate(0.4) hue-rotate(-40deg) blur(2px); }
      75% { filter: brightness(0.8) saturate(0.7) hue-rotate(-20deg) blur(1px); }
      100% { filter: brightness(1) saturate(1) hue-rotate(0deg) blur(0px); }
    }

    .viewport.spectre-attack::after {
      content: '';
      position: absolute;
      inset: 0;
      background: radial-gradient(circle at 50% 40%, rgba(150, 130, 200, 0.5) 0%, rgba(100, 80, 150, 0.3) 40%, transparent 70%);
      animation: spectreWisp 0.5s ease-out;
      pointer-events: none;
      z-index: 100;
    }

    @keyframes spectreWisp {
      0% { opacity: 0; transform: translateY(20px) scale(0.8); }
      40% { opacity: 1; transform: translateY(-10px) scale(1.1); }
      100% { opacity: 0; transform: translateY(-30px) scale(0.9); }
    }

    /* Slime attack shader - gooey sludge effect */
    .viewport.slime-attack {
      animation: slimeShader 0.5s ease-out;
    }

    @keyframes slimeShader {
      0% { filter: brightness(1) saturate(1) hue-rotate(0deg); }
      30% { filter: brightness(0.9) saturate(1.4) hue-rotate(40deg); }
      60% { filter: brightness(0.85) saturate(1.6) hue-rotate(60deg) contrast(1.1); }
      100% { filter: brightness(1) saturate(1) hue-rotate(0deg); }
    }

    .viewport.slime-attack::after {
      content: '';
      position: absolute;
      inset: 0;
      background: radial-gradient(ellipse at 50% 70%, rgba(100, 200, 80, 0.5) 0%, rgba(60, 150, 40, 0.3) 40%, transparent 60%);
      animation: slimeSplat 0.5s ease-out;
      pointer-events: none;
      z-index: 100;
    }

    @keyframes slimeSplat {
      0% { opacity: 0; transform: scale(0.3) translateY(-20px); }
      50% { opacity: 1; transform: scale(1.3) translateY(10px); }
      100% { opacity: 0; transform: scale(1.5) translateY(20px); }
    }

    /* Fire attack shader - flame burst effect */
    .viewport.fire-attack {
      animation: fireShader 0.5s ease-out;
    }

    @keyframes fireShader {
      0% { filter: brightness(1) saturate(1) hue-rotate(0deg); }
      20% { filter: brightness(1.3) saturate(1.5) hue-rotate(-10deg); }
      40% { filter: brightness(1.5) saturate(2) hue-rotate(-20deg) contrast(1.2); }
      60% { filter: brightness(1.3) saturate(1.8) hue-rotate(-15deg); }
      100% { filter: brightness(1) saturate(1) hue-rotate(0deg); }
    }

    .viewport.fire-attack::after {
      content: '';
      position: absolute;
      inset: 0;
      background: radial-gradient(circle at 50% 60%, rgba(255, 150, 50, 0.6) 0%, rgba(255, 80, 20, 0.4) 30%, rgba(200, 50, 0, 0.2) 50%, transparent 70%);
      animation: fireBurst 0.5s ease-out;
      pointer-events: none;
      z-index: 100;
    }

    @keyframes fireBurst {
      0% { opacity: 0; transform: scale(0.5); }
      30% { opacity: 1; transform: scale(1.2); }
      60% { opacity: 0.8; transform: scale(1.4); }
      100% { opacity: 0; transform: scale(1.6); }
    }

    /* Heal particles */
    .heal-particle {
      width: 8px;
      height: 8px;
      background: #58f858;
      border-radius: 50%;
      box-shadow: 0 0 10px #58f858, 0 0 20px #20b820;
      animation: healSparkle 0.8s ease-out forwards;
    }

    @keyframes healSparkle {
      0% { opacity: 0; transform: scale(0) translateY(20px); }
      30% { opacity: 1; transform: scale(1.5) translateY(10px); }
      100% { opacity: 0; transform: scale(0.5) translateY(-30px); }
    }

    /* Super heal */
    .super-heal-particle {
      width: 10px;
      height: 10px;
      background: linear-gradient(135deg, #ffd23f 0%, #f7931e 100%);
      border-radius: 2px;
      transform: rotate(45deg);
      box-shadow: 0 0 12px #ffd23f, 0 0 24px #f7931e;
      animation: superHealSparkle 1s ease-out forwards;
    }

    @keyframes superHealSparkle {
      0% { opacity: 0; transform: rotate(0deg) scale(0) translateY(30px); }
      40% { opacity: 1; transform: rotate(180deg) scale(1.2) translateY(0); }
      100% { opacity: 0; transform: rotate(360deg) scale(0) translateY(-40px); }
    }

    /* Max heal */
    .max-heal-particle {
      width: 12px;
      height: 12px;
      border-radius: 50%;
      animation: maxHealBurst 1.2s ease-out forwards;
    }

    @keyframes maxHealBurst {
      0% { opacity: 0; transform: scale(0); }
      30% { opacity: 1; transform: scale(2); }
      100% { opacity: 0; transform: scale(0.5) translateY(-50px); }
    }

    /* Antidote particles - purple/blue cleansing */
    .antidote-particle {
      width: 8px;
      height: 8px;
      background: linear-gradient(135deg, #e0aaff 0%, #9d4edd 100%);
      border-radius: 50%;
      box-shadow: 0 0 10px #c77dff, 0 0 20px #9d4edd;
      animation: antidoteRise 0.9s ease-out forwards;
    }

    @keyframes antidoteRise {
      0% { opacity: 0; transform: scale(0) translateY(20px); }
      30% { opacity: 1; transform: scale(1.2) translateY(0); }
      100% { opacity: 0; transform: scale(0.5) translateY(-40px); }
    }

    /* Burn cure particles - cool blue soothing */
    .burn-cure-particle {
      width: 9px;
      height: 9px;
      background: linear-gradient(135deg, #88ddff 0%, #44aadd 100%);
      border-radius: 50%;
      box-shadow: 0 0 10px #88ddff, 0 0 20px #44aadd;
      animation: burnCureCool 0.9s ease-out forwards;
    }

    @keyframes burnCureCool {
      0% { opacity: 0; transform: scale(0) translateY(20px); }
      30% { opacity: 1; transform: scale(1.3) translateY(0); }
      100% { opacity: 0; transform: scale(0.4) translateY(-35px); }
    }

    /* Attack projectiles */
    .projectile {
      position: absolute;
      border-radius: 50%;
      z-index: 35;
      pointer-events: none;
    }

    /* EMBER - flickering teardrop flame */
    .projectile.ember {
      width: 14px;
      height: 20px;
      background: linear-gradient(180deg, #fff8e0 0%, #ffd23f 30%, #ff6b35 70%, #cc3300 100%);
      border-radius: 50% 50% 50% 50% / 60% 60% 40% 40%;
      box-shadow: 0 0 14px #ff6b35, 0 0 28px #f7931e;
      animation: emberFlicker 0.1s ease-in-out infinite;
    }

    @keyframes emberFlicker {
      0%, 100% { transform: scaleX(1) scaleY(1); }
      50% { transform: scaleX(0.85) scaleY(1.1); }
    }

    /* FLAMETHROWER - elongated fire stream */
    .projectile.flamethrower {
      width: 35px;
      height: 18px;
      background: linear-gradient(90deg, #cc3300 0%, #ff6b35 20%, #ffd23f 50%, #fff 80%, #ffd23f 100%);
      border-radius: 20% 80% 80% 20% / 50% 50% 50% 50%;
      box-shadow: 0 0 20px #ff6b35, 0 0 40px #f7931e, 0 -5px 30px #ffd23f;
      animation: flameStream 0.08s ease-in-out infinite;
    }

    @keyframes flameStream {
      0%, 100% { transform: scaleX(1) skewX(0deg); }
      25% { transform: scaleX(1.1) skewX(-3deg); }
      75% { transform: scaleX(0.95) skewX(3deg); }
    }

    /* SHADOW BALL - swirling dark energy */
    .projectile.shadow-ball {
      width: 24px;
      height: 24px;
      background: radial-gradient(circle at 30% 30%, #e0aaff 0%, #9d4edd 25%, #7b2cbf 50%, #3c096c 80%, #240046 100%);
      border-radius: 50%;
      box-shadow: 0 0 18px #9d4edd, 0 0 36px #7b2cbf, inset 0 0 10px #240046;
      animation: shadowSwirl 0.2s linear infinite;
    }

    @keyframes shadowSwirl {
      0% { transform: rotate(0deg); background-position: 0% 0%; }
      100% { transform: rotate(360deg); }
    }

    /* FIRE BLAST - explosive star shape */
    .projectile.fire-blast {
      width: 40px;
      height: 40px;
      background: radial-gradient(circle, #fff 0%, #ffd23f 15%, #ff6b35 35%, #cc3300 60%, #660000 100%);
      clip-path: polygon(50% 0%, 61% 35%, 98% 35%, 68% 57%, 79% 91%, 50% 70%, 21% 91%, 32% 57%, 2% 35%, 39% 35%);
      box-shadow: 0 0 40px #ff6b35, 0 0 80px #f7931e, 0 0 120px #cc3300;
      animation: fireBlastPulse 0.1s ease-in-out infinite;
    }

    @keyframes fireBlastPulse {
      0%, 100% { transform: scale(1) rotate(0deg); }
      50% { transform: scale(1.15) rotate(18deg); }
    }

    .projectile.void {
      width: 18px;
      height: 18px;
      background: radial-gradient(circle, #c77dff 0%, #9d4edd 40%, #7b2cbf 70%, #240046 100%);
      box-shadow: 0 0 14px #9d4edd, 0 0 28px #7b2cbf;
    }

    .projectile.sludge {
      width: 20px;
      height: 18px;
      background: radial-gradient(ellipse, #98e898 0%, #6bcf6b 30%, #4a9f4a 60%, #2a6f2a 100%);
      box-shadow: 0 0 16px #6bcf6b, 0 0 32px #4a9f4a;
      border-radius: 60% 40% 50% 50%;
      animation: sludgeWobble 0.3s ease-in-out infinite;
    }

    @keyframes sludgeWobble {
      0%, 100% { transform: scaleX(1) scaleY(1); }
      50% { transform: scaleX(1.1) scaleY(0.9); }
    }

    /* Sludge particles */
    .sludge-particle {
      width: 10px;
      height: 10px;
      background: radial-gradient(circle, #98e898 0%, #4a9f4a 70%, #2a6f2a 100%);
      border-radius: 60% 40% 70% 30%;
      box-shadow: 0 0 10px #6bcf6b;
      animation: sludgeDrip 0.6s ease-out forwards;
    }

    @keyframes sludgeDrip {
      0% { opacity: 1; transform: scale(1) translateY(0); }
      100% { opacity: 0; transform: scale(0.5) translateY(25px); }
    }

    /* Ice projectile */
    .projectile.ice {
      width: 18px;
      height: 18px;
      background: radial-gradient(circle, #ffffff 0%, #88ddff 30%, #44aadd 60%, #2288bb 100%);
      box-shadow: 0 0 16px #88ddff, 0 0 32px #44aadd, inset 0 0 8px rgba(255,255,255,0.8);
      border-radius: 50%;
      animation: iceSpin 0.2s linear infinite;
    }

    @keyframes iceSpin {
      0% { transform: rotate(0deg) scale(1); }
      50% { transform: rotate(180deg) scale(1.1); }
      100% { transform: rotate(360deg) scale(1); }
    }

    /* Ice particles */
    .ice-particle {
      width: 8px;
      height: 12px;
      background: linear-gradient(135deg, #ffffff 0%, #88ddff 50%, #44aadd 100%);
      clip-path: polygon(50% 0%, 100% 50%, 50% 100%, 0% 50%);
      box-shadow: 0 0 8px #88ddff;
      animation: iceFall 0.5s ease-out forwards;
    }

    @keyframes iceFall {
      0% { opacity: 1; transform: scale(1) rotate(0deg) translateY(0); }
      100% { opacity: 0; transform: scale(0.3) rotate(180deg) translateY(30px); }
    }

    /* Spore projectile */
    .projectile.spore {
      width: 22px;
      height: 22px;
      background: radial-gradient(circle, #dda0dd 0%, #9370db 30%, #6b4e8b 60%, #4a2c5a 100%);
      box-shadow: 0 0 16px #9370db, 0 0 32px #6b4e8b;
      border-radius: 50%;
      animation: sporePulse 0.3s ease-in-out infinite;
    }

    @keyframes sporePulse {
      0%, 100% { transform: scale(1); filter: brightness(1); }
      50% { transform: scale(1.15); filter: brightness(1.3); }
    }

    /* Spore particles */
    .spore-particle {
      width: 6px;
      height: 6px;
      background: radial-gradient(circle, #dda0dd 0%, #9370db 70%);
      border-radius: 50%;
      box-shadow: 0 0 6px #9370db;
      animation: sporeFloat 0.8s ease-out forwards;
    }

    @keyframes sporeFloat {
      0% { opacity: 1; transform: scale(1) translateY(0) translateX(0); }
      100% { opacity: 0; transform: scale(0.5) translateY(-20px) translateX(var(--spore-drift, 10px)); }
    }

    /* Screen splat overlay */
    .screen-splat {
      position: absolute;
      pointer-events: none;
      z-index: 48;
      opacity: 0;
    }

    .screen-splat.active {
      animation: splatFade 2s ease-out forwards;
    }

    @keyframes splatFade {
      0% { opacity: 0.9; }
      70% { opacity: 0.7; }
      100% { opacity: 0; }
    }

    .splat-blob {
      position: absolute;
      background: radial-gradient(ellipse, #6bcf6b 0%, #4a9f4a 50%, #2a6f2a 80%, transparent 100%);
      border-radius: 50% 40% 60% 50%;
      box-shadow: inset 0 -5px 15px rgba(0,0,0,0.3), 0 0 20px #6bcf6b;
    }

    .splat-drip {
      position: absolute;
      background: linear-gradient(180deg, #4a9f4a 0%, #2a6f2a 100%);
      border-radius: 50% 50% 40% 40%;
      animation: dripDown 2s ease-in forwards;
    }

    @keyframes dripDown {
      0% { transform: translateY(0) scaleY(1); }
      100% { transform: translateY(40px) scaleY(1.5); }
    }

    /* Damage number - BIGGER */
    .damage-num {
      position: absolute;
      font-family: 'Press Start 2P', cursive;
      font-size: 18px;
      color: #fff;
      text-shadow: 3px 3px 0 #000, -2px -2px 0 #000, 2px -2px 0 #000, -2px 2px 0 #000;
      z-index: 40;
      animation: damageFloat 1s ease-out forwards;
      pointer-events: none;
    }

    .damage-num.crit {
      font-size: 24px;
      color: #ff6b35;
    }

    .damage-num.heal {
      color: #58f858;
    }

    @keyframes damageFloat {
      0% { opacity: 1; transform: translateY(0) scale(1); }
      20% { transform: translateY(-10px) scale(1.3); }
      100% { opacity: 0; transform: translateY(-40px) scale(1); }
    }

    /* Impact flash overlay */
    .impact-flash {
      position: absolute;
      inset: 0;
      background: white;
      opacity: 0;
      pointer-events: none;
      z-index: 49;
    }

    .impact-flash.active {
      animation: impactFlash 0.15s ease-out;
    }

    @keyframes impactFlash {
      0% { opacity: 0.7; }
      100% { opacity: 0; }
    }

    /* Bottom rim - control area */
    .bottom-rim {
      height: 120px;
      margin-top: 0.8rem;
      position: relative;
      background: linear-gradient(180deg, rgba(0,0,0,0.05) 0%, transparent 30%);
      border-radius: 0 0 40px 40px;
    }

    .gameboy-shell.dmg-mode .bottom-rim {
      height: 130px;
      border-radius: 0 0 16px 16px;
    }

    /* D-Pad */
    .dpad {
      position: absolute;
      top: 15px;
      left: 20px;
      width: 50px;
      height: 50px;
    }

    .dpad-horizontal, .dpad-vertical {
      position: absolute;
      background: linear-gradient(180deg, #3a3a4a 0%, #2a2a3a 50%, #1a1a2a 100%);
      border-radius: 3px;
      box-shadow:
        inset 0 1px 1px rgba(255,255,255,0.1),
        0 2px 4px rgba(0,0,0,0.4);
    }

    .dpad-horizontal {
      width: 50px;
      height: 16px;
      top: 17px;
      left: 0;
    }

    .dpad-vertical {
      width: 16px;
      height: 50px;
      top: 0;
      left: 17px;
    }

    .dpad-center {
      position: absolute;
      width: 12px;
      height: 12px;
      background: radial-gradient(circle, #4a4a5a 0%, #2a2a3a 100%);
      border-radius: 50%;
      top: 19px;
      left: 19px;
      box-shadow: inset 0 1px 2px rgba(0,0,0,0.5);
    }

    /* DMG D-Pad - darker black */
    .gameboy-shell.dmg-mode .dpad-horizontal,
    .gameboy-shell.dmg-mode .dpad-vertical {
      background: linear-gradient(180deg, #2a2a28 0%, #1a1a18 50%, #0a0a08 100%);
    }

    .gameboy-shell.dmg-mode .dpad-center {
      background: radial-gradient(circle, #3a3a38 0%, #1a1a18 100%);
    }

    /* D-pad clickable areas */
    .dpad-up, .dpad-down, .dpad-left, .dpad-right {
      position: absolute;
      cursor: pointer;
      z-index: 5;
    }

    .dpad-up { top: 0; left: 14px; width: 22px; height: 20px; }
    .dpad-down { bottom: 0; left: 14px; width: 22px; height: 20px; }
    .dpad-left { left: 0; top: 14px; width: 20px; height: 22px; }
    .dpad-right { right: 0; top: 14px; width: 20px; height: 22px; }

    .dpad-up:active ~ .dpad-vertical,
    .dpad-down:active ~ .dpad-vertical {
      box-shadow: inset 0 2px 4px rgba(0,0,0,0.5);
    }

    .dpad-left:active ~ .dpad-horizontal,
    .dpad-right:active ~ .dpad-horizontal {
      box-shadow: inset 0 2px 4px rgba(0,0,0,0.5);
    }

    /* A/B Buttons */
    .ab-buttons {
      position: absolute;
      top: 18px;
      right: 18px;
      transform: rotate(-25deg);
      display: flex;
      gap: 10px;
    }

    .btn-a, .btn-b {
      width: 28px;
      height: 28px;
      border-radius: 50%;
      box-shadow:
        inset 0 2px 3px rgba(255,255,255,0.3),
        inset 0 -2px 3px rgba(0,0,0,0.3),
        0 3px 6px rgba(0,0,0,0.4);
      position: relative;
    }

    .btn-a {
      background: linear-gradient(180deg, #9060b0 0%, #7040a0 50%, #503080 100%);
    }

    .btn-b {
      background: linear-gradient(180deg, #9060b0 0%, #7040a0 50%, #503080 100%);
    }

    .btn-label {
      position: absolute;
      bottom: -14px;
      left: 50%;
      transform: translateX(-50%) rotate(25deg);
      font-size: 6px;
      color: rgba(255,255,255,0.5);
    }

    /* DMG A/B - maroon/dark red */
    .gameboy-shell.dmg-mode .btn-a,
    .gameboy-shell.dmg-mode .btn-b {
      background: linear-gradient(180deg, #a04858 0%, #803040 50%, #602030 100%);
    }

    .gameboy-shell.dmg-mode .btn-label {
      color: rgba(60,60,56,0.7);
    }

    .btn-a:active, .btn-b:active {
      box-shadow:
        inset 0 2px 4px rgba(0,0,0,0.5),
        0 1px 2px rgba(0,0,0,0.3);
      transform: translateY(1px);
    }

    .btn-a, .btn-b {
      cursor: pointer;
      transition: transform 0.05s, box-shadow 0.05s;
    }

    /* START/SELECT */
    .start-select {
      position: absolute;
      top: 45px;
      left: 50%;
      transform: translateX(-50%);
      display: flex;
      gap: 20px;
    }

    .btn-start, .btn-select {
      width: 32px;
      height: 8px;
      background: linear-gradient(180deg, #5a5a6a 0%, #4a4a5a 50%, #3a3a4a 100%);
      border-radius: 4px;
      box-shadow:
        inset 0 1px 1px rgba(255,255,255,0.2),
        0 2px 3px rgba(0,0,0,0.3);
      position: relative;
    }

    .ss-label {
      position: absolute;
      bottom: -12px;
      left: 50%;
      transform: translateX(-50%);
      font-size: 5px;
      color: rgba(255,255,255,0.4);
      white-space: nowrap;
    }

    .gameboy-shell.dmg-mode .btn-start,
    .gameboy-shell.dmg-mode .btn-select {
      background: linear-gradient(180deg, #808078 0%, #707068 50%, #606058 100%);
    }

    .gameboy-shell.dmg-mode .ss-label {
      color: rgba(60,60,56,0.6);
    }

    .btn-start, .btn-select {
      cursor: pointer;
      transition: transform 0.05s, box-shadow 0.05s;
    }

    .btn-start:active, .btn-select:active {
      box-shadow: inset 0 2px 3px rgba(0,0,0,0.5);
      transform: translateY(1px);
    }

    /* Speaker grille in bottom rim */
    .speaker-grille {
      position: absolute;
      top: 60px;
      right: 15px;
      width: 40px;
      height: 40px;
      background:
        repeating-linear-gradient(
          45deg,
          #4a3a64 0px, #4a3a64 2px,
          #3a2a54 2px, #3a2a54 5px
        );
      border-radius: 50%;
      box-shadow: inset 0 2px 4px rgba(0,0,0,0.5);
    }

    .gameboy-shell.dmg-mode .speaker-grille {
      background:
        repeating-linear-gradient(
          180deg,
          #606058 0px, #606058 4px,
          #808078 4px, #808078 6px
        );
      border-radius: 4px;
      width: 45px;
      height: 35px;
      top: 65px;
    }

    /* Footer links - below gameboy */
    .footer {
      position: fixed;
      bottom: 12px;
      left: 50%;
      transform: translateX(-50%);
      text-align: center;
      white-space: nowrap;
      z-index: 10;
    }

    .x-link {
      font-size: 10px;
      color: rgba(255,255,255,0.5);
      text-decoration: none;
      transition: color 0.2s;
    }

    .x-link:hover { color: #fff; }

    .link-divider {
      color: rgba(255,255,255,0.25);
      margin: 0 8px;
      font-size: 10px;
    }

    /* Power LED */
    .power-led {
      position: absolute;
      top: 8px;
      left: 78px;
      width: 6px;
      height: 6px;
      background: #58f858;
      border-radius: 50%;
      box-shadow: 0 0 6px #58f858;
      animation: ledPulse 2s ease-in-out infinite;
    }

    @keyframes ledPulse {
      0%, 100% { box-shadow: 0 0 8px #58f858; }
      50% { box-shadow: 0 0 15px #58f858, 0 0 25px #20b820; }
    }

    /* Responsive scaling - shrink entire gameboy proportionally */
    @media (max-height: 920px) {
      .gameboy-shell {
        transform: scale(0.9);
        transform-origin: center center;
      }
    }

    @media (max-height: 820px) {
      .gameboy-shell {
        transform: scale(0.8);
        transform-origin: center center;
      }
    }

    @media (max-height: 720px) {
      .gameboy-shell {
        transform: scale(0.7);
        transform-origin: center center;
      }
    }

    @media (max-height: 620px) {
      .gameboy-shell {
        transform: scale(0.6);
        transform-origin: center center;
      }
    }

    @media (max-height: 520px) {
      .gameboy-shell {
        transform: scale(0.5);
        transform-origin: center center;
      }
    }

    @media (max-width: 480px) {
      .gameboy-shell {
        transform: scale(0.85);
        transform-origin: center center;
      }
    }

    @media (max-width: 400px) {
      .gameboy-shell {
        transform: scale(0.7);
        transform-origin: center center;
      }
    }

    @media (max-width: 340px) {
      .gameboy-shell {
        transform: scale(0.6);
        transform-origin: center center;
      }
    }
